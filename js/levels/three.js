import { splash } from "../Splash";
import { Striker } from "../Traits";
import { defineLevel } from "./defineLevel";
import { clamp } from "../math";

const spec = {
  name: "haste",
  spawn: [96, 64],
  background: {
    images: {
      sky: require("../../img/backgrounds/clouds.png"),
      back: require("../../img/backgrounds/mountains.png"),
      front: require("../../img/backgrounds/forest.png")
    },
    gradient: camPos => {
      return [
        ["#256bcc", 0],
        ["#2278c6", clamp(0.4 - camPos.y * 0.0001, 0, 0.8)],
        ["#00c7a4", 0.8]
      ];
    }
  },
  sounds: [
    {
      url: require("../../sounds/hooked-on-a-feeling.mp3"),
      name: "music"
    }
  ],
  tileSprite: {
    imageURL: require("../../img/tiles/y5lxj.png"),
    tileW: 60,
    tileH: 60,
    frames: [
      {
        name: "grass",
        rect: [60 * 0, 0, 60, 60]
      },
      {
        name: "stone",
        rect: [60 * 1, 0, 60, 60]
      },
      {
        name: "dirt",
        rect: [60 * 2, 0, 60, 60]
      },
      {
        name: "default",
        rect: [60 * 3, 0, 60, 60]
      },

      {
        name: "stone2",
        rect: [60 * 0, 60, 60, 60]
      },
      {
        name: "wood",
        rect: [60 * 1, 60, 60, 60]
      },
      {
        name: "sand",
        rect: [60 * 2, 60, 60, 60]
      }
    ]
  },
  tiles: [
    ["default", 1, 7],
    ["default", 2, 7],
    ["default", 3, 7],
    ["default", 4, 7],
    ["default", 5, 7],
    ["default", 6, 7],
    ["default", 7, 7],
    ["default", 8, 7],
    ["default", 9, 7],
    ["default", 10, 7],
    ["default", 11, 7],
    ["default", 12, 7],
    ["default", 13, 7],
    ["default", 14, 7],
    ["default", 15, 7],
    ["default", 16, 7],
    ["default", 17, 7],
    ["default", 18, 7],
    ["default", 19, 7],
    ["default", 20, 7],
    ["default", 21, 7],
    ["default", 22, 7],
    ["default", 23, 7],
    ["default", 24, 7],
    ["default", 25, 7],
    ["default", 26, 7],
    ["default", 40, 7],
    ["default", 41, 7],
    ["default", 42, 7],
    ["default", 43, 7],
    ["default", 44, 7],
    ["default", 45, 7],
    ["default", 46, 7],
    ["default", 47, 7],
    ["default", 48, 7],
    ["default", 49, 7],
    ["default", 50, 7],
    ["wood", 61, 2],
    ["wood", 62, 2],
    ["wood", 63, 2],
    ["wood", 68, 1],
    ["wood", 69, 1],
    ["wood", 70, 1],
    ["wood", 71, 1],
    ["wood", 72, 1],
    ["wood", 73, 1],
    ["wood", 84, 3],
    ["default", 84, 4],
    ["dirt", 84, 5],
    ["dirt", 84, 6],
    ["wood", 85, 4],
    ["default", 85, 5],
    ["dirt", 85, 6],
    ["default", 86, 6],
    ["default", 87, 6],
    ["default", 88, 6],
    ["default", 89, 6],
    ["default", 90, 6],
    ["default", 91, 6],
    ["default", 92, 6],
    ["default", 93, 6],
    ["default", 94, 6],
    ["default", 95, 6],
    ["default", 96, 6],
    ["default", 97, 6],
    ["default", 98, 6],
    ["default", 99, 6],
    ["default", 100, 6],
    ["default", 101, 6],
    ["default", 102, 6],
    ["default", 103, 6],
    ["default", 104, 6],
    ["default", 105, 6],
    ["default", 106, 6],
    ["default", 107, 6],
    ["default", 108, 6],
    ["default", 109, 6],
    ["default", 110, 6],
    ["default", 111, 6],
    ["default", 112, 6],
    ["default", 113, 6],
    ["default", 114, 6],
    ["default", 115, 6],
    ["default", 116, 6],
    ["default", 117, 6],
    ["default", 118, 6],
    ["default", 119, 6],
    ["default", 120, 6],
    ["default", 121, 6],
    ["default", 122, 6],
    ["default", 123, 6],
    ["default", 124, 6],
    ["default", 125, 6],
    ["default", 126, 6],
    ["default", 127, 6],
    ["default", 128, 6],
    ["default", 129, 6],
    ["stone2", 145, 2],
    ["stone2", 146, 2],
    ["stone2", 147, 2],
    ["wood", 154, 4],
    ["wood", 155, 4],
    ["wood", 156, 4],
    ["wood", 157, 4],
    ["wood", 158, 4],
    ["wood", 165, 2],
    ["wood", 166, 2],
    ["wood", 167, 2],
    ["wood", 168, 2],
    ["wood", 169, 2],
    ["wood", 176, 0],
    ["wood", 177, 0],
    ["wood", 178, 0],
    ["wood", 179, 0],
    ["wood", 183, 2],
    ["wood", 184, 2],
    ["wood", 185, 2],
    ["wood", 186, 2],
    ["wood", 187, 2],
    ["wood", 191, 9],
    ["wood", 192, 9],
    ["wood", 193, 9],
    ["wood", 197, 9],
    ["wood", 198, 9],
    ["wood", 199, 9],
    ["wood", 200, 9],
    ["wood", 201, 9],
    ["wood", 202, 9],
    ["wood", 207, 9],
    ["wood", 212, 6],
    ["wood", 216, 5],
    ["wood", 220, 4],
    ["wood", 224, 3],
    ["wood", 228, 3],
    ["wood", 232, 3],
    ["wood", 236, 3],
    ["wood", 238, 4],
    ["wood", 240, 5],
    ["default", 242, 6],
    ["default", 243, 6],
    ["default", 244, 6],
    ["default", 245, 6],
    ["default", 246, 6],
    ["default", 247, 6],
    ["default", 248, 6],
    ["default", 249, 6],
    ["default", 250, 6],
    ["default", 251, 6],
    ["default", 252, 6],
    ["default", 253, 6],
    ["default", 254, 6],
    ["default", 255, 6],
    ["default", 256, 6],
    ["default", 257, 6],
    ["default", 258, 6],
    ["default", 259, 6],
    ["default", 260, 6],
    ["default", 261, 6],
    ["default", 262, 6],
    ["default", 263, 6],
    ["default", 264, 6],
    ["default", 267, 6],
    ["default", 268, 6],
    ["default", 269, 6],
    ["default", 270, 6],
    ["default", 271, 6],
    ["default", 272, 6],
    ["default", 273, 6],
    ["default", 274, 6],
    ["default", 275, 6],
    ["default", 276, 6],
    ["default", 279, 6],
    ["default", 280, 6],
    ["default", 281, 6],
    ["default", 282, 6],
    ["default", 283, 6],
    ["default", 284, 6],
    ["default", 285, 6],
    ["default", 286, 6],
    ["default", 287, 6],
    ["default", 288, 6],
    ["default", 289, 6],
    ["default", 290, 6],
    ["default", 291, 6],
    ["default", 294, 6],
    ["default", 295, 6],
    ["default", 296, 6],
    ["default", 297, 6],
    ["default", 298, 6],
    ["default", 299, 6],
    ["default", 300, 6],
    ["default", 301, 6],
    ["default", 302, 6],
    ["default", 304, 6],
    ["default", 305, 6],
    ["default", 306, 6],
    ["default", 309, 6],
    ["default", 310, 6],
    ["default", 311, 6],
    ["default", 312, 6],
    ["default", 315, 6],
    ["default", 316, 6],
    ["default", 317, 6],
    ["default", 318, 6],
    ["default", 319, 6],
    ["default", 320, 6],
    ["default", 321, 6],
    ["default", 322, 6],
    ["default", 323, 6],
    ["default", 324, 6],
    ["default", 327, 6],
    ["default", 328, 6],
    ["default", 331, 6],
    ["default", 332, 6],
    ["default", 333, 6],
    ["default", 334, 6],
    ["default", 336, 6],
    ["default", 337, 6],
    ["default", 338, 6],
    ["default", 339, 6],
    ["default", 340, 6],
    ["default", 341, 6],
    ["default", 343, 6],
    ["default", 344, 6],
    ["default", 345, 6],
    ["default", 346, 6],
    ["default", 347, 6],
    ["default", 349, 6],
    ["default", 350, 6],
    ["default", 351, 6],
    ["default", 352, 6],
    ["default", 353, 6],
    ["default", 354, 6],
    ["default", 355, 6],
    ["default", 356, 6],
    ["default", 357, 6],
    ["default", 358, 6],
    ["default", 359, 6],
    ["stone2", 362, 4],
    ["stone2", 362, 5],
    ["stone2", 362, 6],
    ["wood", 363, 5],
    ["stone2", 363, 6],
    ["stone2", 364, 6],
    ["wood", 365, 5],
    ["stone2", 365, 6],
    ["stone2", 366, 4],
    ["stone2", 366, 5],
    ["stone2", 366, 6],
    ["wood", 367, 5],
    ["stone2", 367, 6],
    ["stone2", 368, 6],
    ["wood", 369, 5],
    ["stone2", 369, 6],
    ["stone2", 370, 4],
    ["stone2", 370, 5],
    ["stone2", 370, 6],
    ["wood", 371, 5],
    ["stone2", 371, 6],
    ["stone2", 372, 6],
    ["wood", 373, 5],
    ["stone2", 373, 6],
    ["stone2", 374, 4],
    ["stone2", 374, 5],
    ["stone2", 374, 6],
    ["wood", 375, 5],
    ["stone2", 375, 6],
    ["stone2", 376, 6],
    ["wood", 377, 5],
    ["stone2", 377, 6],
    ["stone2", 378, 4],
    ["stone2", 378, 5],
    ["stone2", 378, 6],
    ["dirt", 383, 6],
    ["default", 384, 3],
    ["dirt", 384, 4],
    ["dirt", 384, 6],
    ["default", 385, 2],
    ["dirt", 385, 3],
    ["dirt", 385, 4],
    ["dirt", 385, 6],
    ["default", 386, 2],
    ["dirt", 386, 3],
    ["dirt", 386, 4],
    ["dirt", 386, 6],
    ["default", 388, 3],
    ["dirt", 388, 4],
    ["dirt", 388, 6],
    ["default", 389, 2],
    ["dirt", 389, 3],
    ["dirt", 389, 4],
    ["dirt", 389, 6],
    ["default", 390, 2],
    ["dirt", 390, 3],
    ["dirt", 390, 6],
    ["default", 391, 1],
    ["dirt", 391, 2],
    ["dirt", 391, 6],
    ["default", 392, 1],
    ["dirt", 392, 2],
    ["dirt", 392, 3],
    ["dirt", 392, 4],
    ["dirt", 392, 5],
    ["dirt", 392, 6],
    ["default", 393, 1],
    ["dirt", 393, 2],
    ["dirt", 393, 3],
    ["dirt", 393, 4],
    ["dirt", 393, 5],
    ["dirt", 393, 6],
    ["default", 394, 0],
    ["dirt", 394, 1],
    ["dirt", 394, 2],
    ["dirt", 394, 3],
    ["dirt", 394, 4],
    ["dirt", 394, 6],
    ["default", 395, 0],
    ["dirt", 395, 1],
    ["dirt", 395, 6],
    ["default", 396, 0],
    ["dirt", 396, 1],
    ["dirt", 396, 4],
    ["dirt", 396, 6],
    ["default", 397, 0],
    ["dirt", 397, 1],
    ["dirt", 397, 4],
    ["dirt", 397, 5],
    ["dirt", 397, 6],
    ["default", 398, 0],
    ["dirt", 398, 1],
    ["dirt", 398, 4],
    ["dirt", 398, 5],
    ["dirt", 398, 6],
    ["default", 399, 0],
    ["dirt", 399, 1],
    ["dirt", 399, 4],
    ["dirt", 399, 5],
    ["default", 400, 0],
    ["dirt", 400, 1],
    ["dirt", 400, 4],
    ["dirt", 400, 5],
    ["dirt", 400, 6],
    ["dirt", 401, 2],
    ["dirt", 401, 4],
    ["dirt", 401, 5],
    ["dirt", 401, 6],
    ["dirt", 402, 2],
    ["dirt", 402, 3],
    ["dirt", 402, 4],
    ["dirt", 402, 5],
    ["dirt", 403, 4],
    ["default", 404, -1],
    ["dirt", 404, 0],
    ["dirt", 404, 1],
    ["dirt", 404, 4],
    ["default", 405, -1],
    ["dirt", 405, 0],
    ["dirt", 405, 4],
    ["default", 406, -1],
    ["dirt", 406, 0],
    ["dirt", 406, 1],
    ["dirt", 406, 4],
    ["dirt", 407, 1],
    ["dirt", 407, 2],
    ["dirt", 407, 3],
    ["dirt", 407, 4],
    ["dirt", 408, 3],
    ["dirt", 408, 4],
    ["default", 409, -2],
    ["dirt", 409, -1],
    ["dirt", 409, 0],
    ["dirt", 409, 4],
    ["default", 410, -2],
    ["dirt", 410, -1],
    ["dirt", 410, 0],
    ["dirt", 410, 4],
    ["default", 411, -1],
    ["dirt", 411, 0],
    ["dirt", 411, 1],
    ["dirt", 411, 2],
    ["dirt", 411, 3],
    ["dirt", 411, 4],
    ["dirt", 411, 5],
    ["default", 412, 0],
    ["dirt", 412, 1],
    ["dirt", 412, 2],
    ["dirt", 412, 3],
    ["dirt", 412, 6],
    ["default", 413, 0],
    ["dirt", 413, 1],
    ["dirt", 413, 6],
    ["default", 414, 0],
    ["dirt", 414, 1],
    ["dirt", 414, 5],
    ["default", 415, 1],
    ["dirt", 415, 2],
    ["dirt", 415, 3],
    ["dirt", 415, 4],
    ["dirt", 415, 5]
  ],
  entities: [
    { name: "manaPot", pos: [485.6330162237009, 348], skinName: "default" },
    { name: "manaPot", pos: [605.6383789811518, 348], skinName: "default" },
    {
      name: "speedBooster",
      pos: [2812.2347522228215, 355.5],
      skinName: "default"
    },
    {
      name: "rainbow",
      pos: [4137.700972128387, -281.40700721319774],
      skinName: "default"
    },
    {
      name: "manaPot",
      pos: [4173.970876438694, -15.806867394646929],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [4355.470876438694, -1.306867394646929],
      skinName: "default"
    },
    { name: "manaPot", pos: [5423.255953223659, 291], skinName: "default" },
    {
      name: "speedBooster",
      pos: [5706.755953223659, 298.5],
      skinName: "default"
    },
    { name: "manaPot", pos: [5873.255953223659, 289], skinName: "default" },
    {
      name: "speedBooster",
      pos: [6187.755953223659, 288.5],
      skinName: "default"
    },
    { name: "manaPot", pos: [6463.255953223659, 282], skinName: "default" },
    {
      name: "speedBooster",
      pos: [6769.755953223659, 301.5],
      skinName: "default"
    },
    { name: "manaPot", pos: [7057.255953223659, 286], skinName: "default" },
    {
      name: "rainbow",
      pos: [9023.31340703079, -143.56851863088718],
      skinName: "default"
    },
    {
      name: "rainbow",
      pos: [11116.838169488621, -432.3583991660562],
      skinName: "default"
    },
    { name: "manaPot", pos: [13550.334932109752, 64], skinName: "default" },
    { name: "manaPot", pos: [13795.334932109752, 70], skinName: "default" },
    { name: "manaPot", pos: [14045.334932109752, 65], skinName: "default" },
    {
      name: "rainbow",
      pos: [14492.279191459636, -110.14351629708781],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [14782.741349921134, 303.5],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [14979.741349921134, 305.5],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [15148.741349921134, 303.5],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [15301.741349921134, 301.5],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [15432.741349921134, 298.5],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [15588.741349921134, 299.5],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [15734.741349921134, 301.5],
      skinName: "default"
    },
    {
      name: "speedBooster",
      pos: [16009.741349921134, 292.5],
      skinName: "default"
    },
    { name: "enemy", pos: [17111.241349921132, 276.5], skinName: "cactus" },
    { name: "enemy", pos: [17836.241349921132, 281.5], skinName: "cactus" },
    { name: "enemy", pos: [19095.241349921132, 264.5], skinName: "target" }
  ]
};

export default defineLevel(spec, createLevelOptions());

function createLevelOptions() {
  const howToSplash = howToSplasher();

  return {
    onStart: (game, level) => {
      // level.sounds.get('music').playOnce();
    },
    afterUpdate: (game, level) => {
      howToSplash(game, level);
    }
  };
}

function howToSplasher() {
  const distance = 500;
  let distanceReached = false;

  return (game, level) => {
    const player = game.playerEnv.playerController.player;

    const nearDistance = Math.abs(player.pos.x - distance) < 10;
    if (!distanceReached && nearDistance) {
      distanceReached = true;
      splash("press shift to boost", { size: 50, timeout: 2000 });
    }
  };
}
