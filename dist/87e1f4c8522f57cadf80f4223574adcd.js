require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var a=e[n]=new t.Module;r[n][0].call(a.exports,i,a,a.exports)}return e[n].exports}function o(){this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({24:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.lerp=e,exports.clamp=r;let t=exports.Matrix=class{constructor(){this.grid=[],this.offset=100}get(t,s){t+=this.offset,s+=this.offset;const e=this.grid[t];if(e)return e[s]}set(t,s,e){t+=this.offset,s+=this.offset,this.grid[t]||(this.grid[t]=[]),this.grid[t][s]=e}remove(t,s){t+=this.offset,s+=this.offset,delete this.grid[t][s]}width(){return this.grid.length-this.offset}*[Symbol.iterator](){for(let t=0;t<this.grid.length;t++)if(this.grid[t])for(let s=0;s<this.grid[t].length;s++){const e=this.grid[t][s];e&&(yield{tile:e,x:t-this.offset,y:s-this.offset})}}},s=exports.Vec2=class t{constructor(t,s){this.set(t,s)}set(t,s){this.x=t,this.y=s}clone(){return new t(this.x,this.y)}distance(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))}};function e(t,s,e){return t*(1-e)+s*e}s.zero=new s(0,0);const i=exports.rand={int:(t,s)=>Math.floor(i.float(t,++s)),float:(t,s)=>Math.random()*(s-t)+t};function r(t,s,e){return t>e?e:t<s?s:t}
},{}],34:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let t=exports.ClipBox=class t{constructor(t,s,e){this.pos=t,this.size=s,this.offset=e}overlaps(t){return this.bottom>t.top&&this.top<t.bottom&&this.left<t.right&&this.right>t.left}contains(t){return this.bottom>=t.y&&this.top<=t.y&&this.left<=t.x&&this.right>=t.x}clone(){return new t(this.pos.clone(),this.size.clone(),this.offset.clone())}get width(){return this.size.x}get height(){return this.size.y}get bottom(){return this.pos.y+this.size.y+this.offset.y}set bottom(t){this.pos.y=t-(this.size.y+this.offset.y)}get top(){return this.pos.y+this.offset.y}set top(t){this.pos.y=t-this.offset.y}get left(){return this.pos.x+this.offset.x}set left(t){this.pos.x=t-this.offset.x}get right(){return this.pos.x+this.size.x+this.offset.x}set right(t){this.pos.x=t-(this.size.x+this.offset.x)}};
},{}],14:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Camera=void 0;var e=require("../math"),r=require("../ClipBox");let s=exports.Camera=class{constructor(){this.pos=new e.Vec2(0,0),this.size=new e.Vec2(1024,600)}getBounds(){return new r.ClipBox(this.pos,this.size,e.Vec2.zero)}};
},{"../math":24,"../ClipBox":34}],16:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let e=exports.CameraController=class{constructor(e,t){this.cam=e,this.extensions=this.loadExtensions(t)}loadExtensions(e){return e.map(e=>{const t=new e(this);return this[t.name]=t,t})}update(e,t,{alcohol:s=!1,earthquake:o=!1}={}){this.extensions.forEach(e=>e.update(...arguments))}};
},{}],36:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let e=exports.CameraExt=class{constructor(e,t){this.name=e,this.controller=t}get cam(){return this.controller.cam}update(e,t,r={}){}};
},{}],17:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CameraFocus=void 0;var t=require("./CameraExt"),i=require("../math");const e={IDLE:Symbol("IDLE"),STARTED:Symbol("STARTED"),REACHED:Symbol("REACHED"),RESTORED:Symbol("RESTORED")};let s=exports.CameraFocus=class extends t.CameraExt{constructor(t){super("focus",t),this.followEntity=void 0,this.noticeEntity=void 0,this.noticeState=e.IDLE,this.noticeTime=void 0,this.noticeResolver=void 0,this.damping=this.defaultDamping,this.camOffset=this.defaultCamOffset,this.reachDistance=500}get defaultDamping(){return.3}get defaultCamOffset(){return new i.Vec2(0,100)}update(t,i,e){e.frozen||(this.checkNotice(t,i),this.following(t,i))}follow(t){this.noticeState!==e.IDLE&&this.stopNotice(),this.followEntity=t,this.entity=t,this.cam.pos.x=t.pos.x,this.cam.pos.y=0}following(t,e){if(!this.entity)return;let s=this.entity.pos.x-this.camOffset.x,o=this.entity.pos.y;Math.abs(this.cam.pos.x-s)>.1&&(s=(0,i.lerp)(this.cam.pos.x,s,1/this.damping*t)),Math.abs(this.cam.pos.y-o)>.1&&(o=(0,i.lerp)(this.cam.pos.y,o,1/this.damping*t)),this.cam.pos.x=s,this.cam.pos.y=Math.min(o,0)}notice(t,i,s){return this.noticeState=e.NOTICE_STARTED,this.noticeEntity=t,this.noticeTime=i,this.entity=t,this.followEntity.run.stop(),s&&(this.camOffset.x=s),new Promise(t=>{this.noticeResolver=t})}onNoticeReach(){this.noticeState=e.REACHED,setTimeout(()=>{this.entity=this.followEntity},this.noticeTime)}onNoticeRestore(t){this.stopNotice()}checkNotice(t,i){this.noticeState===e.STARTED&&(Math.abs(this.entity.pos.x-this.cam.pos.x)<this.reachDistance&&this.onNoticeReach());this.noticeState===e.REACHED&&(Math.abs(this.followEntity.pos.x-this.cam.pos.x)<this.reachDistance&&this.onNoticeRestore(i))}stopNotice(){this.noticeState=e.IDLE,this.followEntity.run.resume(),this.camOffset=this.defaultCamOffset,this.noticeResolver(),this.noticeTime=void 0,this.noticeResolver=void 0}};
},{"./CameraExt":36,"../math":24}],18:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CameraShake=exports.ShakeType=void 0;var t=require("../math"),s=require("./CameraExt");const a=exports.ShakeType={DRUNK:Symbol("DRUNK"),EARTH:Symbol("EARTH")};let e=exports.CameraShake=class extends s.CameraExt{constructor(t){super("shake",t),this.alcoFreq=1,this.alcoAmp=1,this.alcoRand=1,this.alcoDamping=1,this.shakingAmp=50}get entity(){return this.controller.focus.entity}get camOffset(){return this.controller.focus.camOffset}update(t,s,{shakeType:a}={}){a?this.runShake(a,t,s):this.resetFocus()}runShake(t,s,e){switch(t){case a.DRUNK:this.drunk(s,e);break;case a.EARTH:this.earth(s,e)}}resetFocus(){this.controller.focus.damping=this.controller.focus.defaultDamping,this.controller.focus.camOffset=this.controller.focus.defaultCamOffset}drunk(s,a){this.controller.focus.damping=this.alcoDamping;const e=this.alcoRand*t.rand.float(0,1);this.alcoRand=(0,t.lerp)(this.alcoRand,e,s),this.cam.pos.y=100*o(a/1e3,0,Math.sin(this.alcoRand)*this.alcoAmp,Math.sin(this.alcoRand)*this.alcoFreq,0),this.camOffset.x=Math.sin(a/1e3)+500*Math.sin(this.alcoRand)}earth(s,a){this.cam.pos.x=this.entity.pos.x-this.camOffset.x+t.rand.float(0,this.shakingAmp),this.cam.pos.y=t.rand.float(0,this.shakingAmp)}};function o(t,s,a,e,o){return s+a*Math.sin(e*t+o)}
},{"../math":24,"./CameraExt":36}],37:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Entity=exports.Trait=exports.Sides=void 0;var t=require("./math"),s=require("./ClipBox");const i=exports.Sides={TOP:Symbol("TOP"),BOTTOM:Symbol("BOTTOM"),LEFT:Symbol("LEFT"),RIGHT:Symbol("RIGHT")};let e=exports.Trait=class{constructor(t){this.NAME=t,this.tasks=[],this.entity=void 0}finalize(){this.tasks.forEach(t=>t()),this.tasks.length=0}setEntity(t){this.entity=t}queue(t){this.tasks.push(t)}collides(t,s){}obstruct(){}update(){}},h=exports.Entity=class{constructor(i){this.name=i,this.pos=new t.Vec2(0,0),this.vel=new t.Vec2(0,0),this.size=new t.Vec2(0,0),this.offset=new t.Vec2(0,0),this.bounds=new s.ClipBox(this.pos,this.size,this.offset),this.lifetime=0,this.traits=[],this.idx=void 0}addTrait(t){t.setEntity(this),this.traits.push(t),this[t.NAME]=t}removeTrait(t){const s=this.traits.findIndex(s=>s.NAME===t);-1!==s&&(this.traits.splice(s,1),this[t]=void 0)}collides(t,s){this.traits.forEach(i=>{i.collides(this,t,s)})}obstruct(t,s){this.traits.forEach(i=>{i.obstruct(this,t,s)})}draw(){}voice(t){}finalize(){this.traits.forEach(t=>{t.finalize()})}update(t,s){this.voice&&this.voice(this),this.traits.forEach(i=>{i.update(this,t,s)}),this.lifetime+=t}};
},{"./math":24,"./ClipBox":34}],13:[function(require,module,exports) {
"use strict";function e(e,{timeout:t=1e3,size:s=100,color:o="white",background:l="transparent"}={}){const r=document.querySelector(".splash-text"),c=document.querySelector(".splash-block");return new Promise(i=>{c.style=`background-color: ${l}`,r.style=`font-size: ${s}pt; color: ${o};`,r.innerHTML=e,r.classList.toggle("splash-text--hide",!1),r.classList.toggle("splash-text--show",!0),setTimeout(()=>{r.classList.toggle("splash-text--show",!1),r.classList.toggle("splash-text--hide",!0),setTimeout(()=>{i()},300)},t)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.splash=e;
},{}],40:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerController=void 0;var e=require("../Entity"),t=require("../LevelManager"),i=require("../math"),s=require("../Splash");let a=exports.PlayerController=class extends e.Trait{constructor(e){super("playerController"),this.game=e,this.checkpoint=new i.Vec2(0,0),this.player=void 0,this.game.levelManager.on(t.LevelEvents.FINISHED,this.onLevelFinished.bind(this)),this.game.levelManager.on(t.LevelEvents.FAILED,this.onLevelFailed.bind(this)),this.totalScore=0,this.score=0,this.mana=0,this.kills=0,this.deaths=0,this.fireballsSelector=document.getElementById("current-fireballs"),this.scoreSelector=document.getElementById("unicorn-score"),this.updateUiCounts(this.fireballsSelector,this.mana)}setPlayer(e){this.player=e,this.player.picker.on("pick",this.onPick.bind(this)),this.player.striker.on("strike",this.onStrike.bind(this)),this.player.killer.on("kill",this.onKill.bind(this)),this.player.killable.on("dead",this.onDead.bind(this))}onPick(e,t){"rainbow"===t.name&&(this.score+=50,this.updateUiCounts(this.scoreSelector,this.totalScore+this.score)),"manaPot"===t.name&&(this.mana+=2,this.updateUiCounts(this.fireballsSelector,this.mana))}onStrike(e){"bullet"===e.name&&this.mana--,this.updateUiCounts(this.fireballsSelector,this.mana)}onKill(){this.kills++}onDead(){this.deaths++}updateUiCounts(e,t){setTimeout(()=>{e.innerHTML=Math.ceil(t)},0)}canStrikeFireballs(){const e=this.player&&!this.player.killable.dead,t=this.mana>0;return t||(0,s.splash)("no mana",{timeout:1e3,size:30}),e&&t}canBoost(){const e=this.player&&!this.player.killable.dead,t=this.mana>0;return e&&0===this.mana&&(0,s.splash)("no mana",{timeout:1e3,size:30}),e&&t}commitScore(){this.totalScore+=this.score,this.resetScore()}resetScore(){this.score=0,this.updateUiCounts(this.scoreSelector,this.totalScore+this.score)}resetMana(){this.mana=0,this.updateUiCounts(this.fireballsSelector,this.mana)}update(e,t,i){if(this.player)return this.player.killable.dead||i.entities.has(this.player)?void(this.player.run.boosted&&(this.mana-=t,this.mana<=0&&(this.player.run.cancelBoost(),this.mana=0),this.updateUiCounts(this.fireballsSelector,this.mana))):(this.player.pos.set(this.checkpoint.x,this.checkpoint.y),void i.entities.add(this.player))}onLevelFinished({isLastLevel:e}){this.commitScore(),this.resetMana()}onLevelFailed(){this.resetScore(),this.resetMana()}};
},{"../Entity":37,"../LevelManager":9,"../math":24,"../Splash":13}],41:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InteractionController=void 0;var e=require("../Entity");let t=exports.InteractionController=class extends e.Trait{constructor(e){super("interactionController"),this.game=e,this.shiftPressed=!1,this.setupHandlers()}get entityFactory(){return this.game.entityFactory}get playerController(){return this.game.playerEnv.playerController}get currentLevel(){return this.game.levelManager.level}setupHandlers(){["keydown","keyup"].forEach(e=>{window.addEventListener(e,e=>{this.keyHandler(e)})})}keyHandler(e){if(this.playerController.player)switch(this.handleKeyEvent(e),e.code){case"Space":this.jumpHandler(e);break;case"KeyF":this.strikeFireballHandler(e)}}handleKeyEvent(e){const t=e.shiftKey;this.shiftPressed=t}boostChecker(){const e=this.playerController.player;e.killable.dead||e.jump.inAir?e.run.cancelBoost():(this.shiftPressed&&this.playerController.canBoost()&&!e.run.boosted&&e.run.boost(3e4),!this.shiftPressed&&e.run.boosted&&e.run.cancelBoost())}strikeFireballHandler(e){if(!("keydown"===e.type)||!this.playerController.canStrikeFireballs())return;const t=this.playerController.player,r=this.entityFactory.bullet({skinName:"default",ownerEntity:t});t.striker.strike(r,this.currentLevel)}jumpHandler(e){const t=this.playerController.player,r="keydown"===e.type?1:0;t.killable.dead||(r>0?t.jump.start():t.jump.cancel())}update(){this.boostChecker()}};
},{"../Entity":37}],19:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createPlayerEnv=n;var e=require("../Entity"),r=require("./PlayerController"),t=require("./InteractionController");function n(n){const o=new e.Entity("player"),l=new r.PlayerController(n);l.checkpoint.set(96,64),o.addTrait(l);const a=new t.InteractionController(n);return o.addTrait(a),o}
},{"../Entity":37,"./PlayerController":40,"./InteractionController":41}],20:[function(require,module,exports) {
"use strict";function t(t,e,s){let i;return function(){const n=this,o=arguments;clearTimeout(i),i=setTimeout(function(){i=void 0,s||t.apply(n,o)},e),s&&!i&&t.apply(n,o)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounce=t;let e=exports.EventEmitter=class t{static getEmitter(e){let s=t.emitters.get(e);return s||(s=new t,t.emitters.set(e,s)),s}static decorator(e){e.prototype.on=function(...e){const s=t.getEmitter(this);s.on.call(s,...e)},e.prototype.emit=function(...e){const s=t.getEmitter(this);s.emit.call(s,...e)}}constructor(t){this.events=new Map}on(t,e){let s=this.events.get(t);s?s.push(e):(s=[e],this.events.set(t,s))}async emit(t,...e){const s=this.events.get(t);if(s){for(const t of s)t(...e);await Promise.all(s.map(t=>t.bind(t,...e)))}}};e.emitters=new WeakMap;
},{}],52:[function(require,module,exports) {
"use strict";var e,t,i,s,r,o,d,a,h,l;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Striker=exports.Picker=exports.Pickable=exports.Killer=exports.Killable=exports.Jump=exports.Run=exports.Impassable=exports.Stackable=exports.Solid=exports.AutoJump=exports.Physics=void 0;var p=require("./Entity"),n=require("./math"),u=require("./util");let c=exports.Physics=class extends p.Trait{constructor({applyGravity:e}={applyGravity:!0}){super("physics"),this.applyGravity=e}update(e,t,i){e.pos.x+=e.vel.x*t,i.tileCollider.checkX(e),e.pos.y+=e.vel.y*t,i.tileCollider.checkY(e),this.applyGravity&&(e.vel.y+=i.gravity*t)}},m=exports.AutoJump=class extends p.Trait{constructor(){super("autojump")}update(e,t,i){const s=.3*e.vel.x;i.tileCollider.willCollideX(e,s)&&(e.jump.start(),setTimeout(()=>e.jump.cancel(),300))}},v=exports.Solid=class extends p.Trait{constructor(){super("solid"),this.obstructs=!0}obstruct(e,t,i){this.obstructs&&(t===p.Sides.BOTTOM?(e.bounds.bottom=i.y1,e.vel.y=0):t===p.Sides.TOP?(e.bounds.top=i.y2,e.vel.y=0):t===p.Sides.LEFT?(e.bounds.left=i.x2,e.vel.x=0):t===p.Sides.RIGHT&&(e.bounds.right=i.x1,e.vel.x=0))}},b=exports.Stackable=class extends p.Trait{constructor(){super("stackable")}collides(e,t,i){e.name===t.name&&(this.killable&&this.killable.dead||(e.vel.y>0&&i===p.Sides.BOTTOM?(e.bounds.bottom=t.bounds.top,e.vel.y=0):e.vel.y<0&&i===p.Sides.TOP?(e.bounds.top=t.bounds.bottom,e.vel.y=0):e.vel.x>0&&i===p.Sides.RIGHT?(e.bounds.right=t.bounds.left,e.vel.x=0):e.vel.x<0&&i===p.Sides.LEFT&&(e.bounds.left=t.bounds.right,e.vel.x=0)))}},x=exports.Impassable=class extends p.Trait{constructor(){super("impassable"),this.activated=!0}activate(){this.queue(()=>this.activated=!0)}deactivate(){this.queue(()=>this.activated=!1)}collides(e,t,i){this.activated&&(i===p.Sides.BOTTOM?(t.bounds.top=e.bounds.bottom,t.vel.y=0):i===p.Sides.TOP?(t.bounds.bottom=e.bounds.top,t.vel.y=0):i===p.Sides.RIGHT?(t.bounds.left=e.bounds.right,t.vel.x=0):i===p.Sides.LEFT&&(t.bounds.right=e.bounds.left,t.vel.x=0),t.obstruct(t,i))}},T=exports.Run=class extends p.Trait{constructor({speed:e=15e3}){super("run"),this.speed=e,this.realSpeed=this.speed,this.lastSpeed=this.speed,this.originSpeed=void 0,this.damping=1,this.distance=0,this.onGround=!1,this.boosted=!1}stop(){this.originSpeed&&this.resume(),this.originSpeed=this.speed,this.speed=1}resume(){this.originSpeed&&(this.speed=this.originSpeed,this.originSpeed=void 0)}boost(e){this.boosted||(this.originSpeed=this.speed,this.speed=this.originSpeed+e,this.boosted=!0)}cancelBoost(){this.boosted&&(this.speed=this.originSpeed,this.originSpeed=void 0,this.boosted=!1)}update(e,t){this.realSpeed=this.speed,Math.abs(this.lastSpeed-this.speed)>0&&(this.realSpeed=(0,n.lerp)(this.lastSpeed,this.speed,1/this.damping*t)),e.vel.x=this.realSpeed*t,this.distance+=Math.abs(e.vel.x)*t,this.lastSpeed=this.realSpeed}},g=exports.Jump=class extends p.Trait{constructor(){super("jump"),this.falling=!1,this.jumping=!1,this.ready=0,this.duration=.8,this.engageTime=0,this.requestTime=0,this.gracePeriod=.1,this.speedBoost=.3,this.velocity=200,this.enabled=!0}get fallingDown(){return this.ready<0&&this.falling}get jumpingUp(){return this.ready<0&&this.jumping}get inAir(){return this.fallingDown||this.jumpingUp}start(){this.enabled&&(this.requestTime=this.gracePeriod)}cancel(){this.enabled&&(this.engageTime=0,this.requestTime=0)}obstruct(e,t){t===p.Sides.BOTTOM?(this.ready=1,this.falling=!1):t===p.Sides.TOP&&this.cancel()}update(e,t){this.ready<0&&e.vel.y<0?(this.jumping=!0,this.falling=!1):this.ready<0&&e.vel.y>0&&(this.jumping=!1,this.falling=!0),this.requestTime>0&&(this.ready>0&&(this.engageTime=this.duration,this.requestTime=0),this.requestTime-=t),this.engageTime>0&&(e.vel.y=-(this.velocity+Math.abs(e.vel.x)*this.speedBoost),this.engageTime-=t,this.engageTime<0&&(this.engageTime=0)),this.ready--}},k=exports.Killable=(e=u.EventEmitter.decorator)(t=class extends p.Trait{constructor({removeAfter:e}={}){super("killable"),this.dead=!1,this.deadTime=0,this.removeAfter=void 0!==e?e:.3}kill(){this.dead||(this.emit("dead"),this.queue(()=>this.dead=!0))}revive(){this.dead=!1,this.deadTime=0}update(e,t,i){if(this.dead)return e.vel.x=.3*e.vel.x,this.deadTime+=t,void(this.deadTime>this.removeAfter&&this.queue(()=>{i.entities.delete(e)}))}})||t,S=exports.Killer=(i=u.EventEmitter.decorator)(s=class extends p.Trait{constructor(){super("killer")}kill(e){this.emit("kill",e)}})||s,y=exports.Pickable=(r=u.EventEmitter.decorator)(o=class extends p.Trait{constructor({onPick:e}={}){super("pickable"),this.picked=!1,this.pickTime=0,this.removeAfter=.3,e&&this.on("pick",e)}pick(){this.emit("pick"),this.queue(()=>this.picked=!0)}update(e,t,i){this.picked&&(this.pickTime+=t,this.pickTime>this.removeAfter&&this.queue(()=>{i.entities.delete(e)}))}})||o,f=exports.Picker=(d=u.EventEmitter.decorator)(a=class extends p.Trait{constructor(){super("picker")}collides(e,t){t.pickable&&!t.pickable.picked&&this.emit("pick",e,t)}})||a,q=exports.Striker=(h=u.EventEmitter.decorator)(l=class extends p.Trait{constructor(){super("striker"),this.reloadDuration=.1,this.canStrike=!0,this.strikeTime=0}isStriking(){return this.strikeTime>0&&this.strikeTime<this.reloadDuration}strike(e,t){this.canStrike&&(e.pos.x=this.entity.pos.x+100,e.pos.y=this.entity.pos.y+40,e.vel.x=1e3,t.entities.add(e),this.canStrike=!1,this.strikeTime=0,e.bulletBehavior.striked(),this.emit("strike",e))}update(e,t,i){this.canStrike||(this.strikeTime+=t,this.strikeTime>this.reloadDuration&&(this.canStrike=!0,this.strikeTime=0))}})||l;
},{"./Entity":37,"./math":24,"./util":20}],81:[function(require,module,exports) {
module.exports="f1ecb4c5aae51ac1c82c3e2d17b666a0.wav";
},{}],82:[function(require,module,exports) {
module.exports="f528c7ca9edef7acaf8678528cb2a803.png";
},{}],77:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../math"),t=require("../player/createPlayerEnv"),n=require("../Traits");const r=100;function o(){const t=["speedBooster"];return Array.from(Array(r)).map((n,r)=>({name:t[e.rand.int(0,t.length-1)],pos:[r*e.rand.int(1e3,2e3)+500,-1e3]}))}function a(){let t=5,n=1,o=0;return Array.from(Array(r)).map(()=>{n=-3===t?1:n,n=9===t?-1:n;const r=e.rand.int(15,30),a=[o,r,t,1];return t+=n,o=o+r+1,a})}const s=a(),i=o(),c={background:{images:{},gradient:e=>{return[["#ffffff",0],["#ffffff",1]]}},sounds:[{url:require("../../sounds/music/demo.wav"),name:"music"}],tileSprite:{imageURL:require("../../img/tiles/trak2_wall1a.png"),tileW:60,tileH:60,frames:[{name:"default",rect:[0,0,60,60]}]},tiles:s,entities:i};function l(e){const t=document.querySelector(".play-btn");async function n(){document.querySelector(".play-block").remove(),window.removeEventListener("keydown",r),await e.levelManager.nextLevel(),e.canvasSelector.classList.toggle("blur",!1)}function r(e){"Space"===e.code&&n()}t.style.visibility="visible",t.addEventListener("click",function(){n()}),t.addEventListener("mouseover",function(){e.canvasSelector.classList.toggle("blur",!0)}),t.addEventListener("mouseout",function(){e.canvasSelector.classList.toggle("blur",!1)}),window.addEventListener("keydown",r)}async function u(e){const r=await e.loadLevel(c),o=e.entityFactory.unicorn({speed:2e4});o.addTrait(new n.AutoJump);const a=(0,t.createPlayerEnv)(e);return r.entities.add(a),r.entities.forEach(e=>e.addTrait(new n.Physics)),l(e),{level:r,startLevel:function(){r.sounds.get("music").playLoop({volume:.8}),a.playerController.setPlayer(o),e.cameraController.focus.follow(o),e.timer.update=((t,n)=>{o.pos.x>r.distance&&(o.pos.x=64,o.pos.y=64),r.update(t),e.cameraController.update(t,n,r),r.comp.draw(e.context,e.camera)})},stopLevel:function(){for(const[e,t]of r.sounds.entries())t.stop()}}}exports.default={spec:c,init:u};
},{"../math":24,"../player/createPlayerEnv":19,"../Traits":52,"../../sounds/music/demo.wav":81,"../../img/tiles/trak2_wall1a.png":82}],88:[function(require,module,exports) {
"use strict";function e(e,t){return{spec:e,init:async function(r){const n=await r.loadLevel(e),o=r.playerEnv,a=r.entityFactory.unicorn();return n.entities.add(o),o.playerController.checkpoint.set(e.spawn[0],e.spawn[1]),{level:n,startLevel:function(){t.onStart&&t.onStart(r,n),o.playerController.setPlayer(a),r.cameraController.focus.follow(a),r.timer.update=((e,o)=>{n.update(e),r.levelManager.update(e,o,n),r.cameraController.update(e,o,n),n.comp.draw(r.context,r.camera),t.afterUpdate&&t.afterUpdate(r,n)})},stopLevel:function(){for(const[e,t]of n.sounds.entries())t.stop()}}}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.defineLevel=e;
},{}],84:[function(require,module,exports) {
module.exports="33f9e95192f7d4f800fc6dead92d1536.png";
},{}],85:[function(require,module,exports) {
module.exports="dd47bf358ec24a59aff3ebb6549b4fd5.png";
},{}],86:[function(require,module,exports) {
module.exports="d290ed1ad8dd4323f1573231ca89335b.png";
},{}],83:[function(require,module,exports) {
module.exports="1dbbb8aca01f558b79636d70dce5b20c.mp3";
},{}],87:[function(require,module,exports) {
module.exports="5956ea456339dd2bc9e30426631d0c43.png";
},{}],78:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../Splash"),t=require("../Traits"),d=require("./defineLevel"),a=require("../math");const u={name:"warm up",spawn:[96,64],background:{images:{sky:require("../../img/backgrounds/clouds.png"),back:require("../../img/backgrounds/mountains.png"),front:require("../../img/backgrounds/forest.png")},gradient:e=>[["#256bcc",0],["#2278c6",(0,a.clamp)(.4-1e-4*e.y,0,.8)],["#00c7a4",.8]]},sounds:[{url:require("../../sounds/hooked-on-a-feeling.mp3"),name:"music"}],tileSprite:{imageURL:require("../../img/tiles/y5lxj.png"),tileW:60,tileH:60,frames:[{name:"grass",rect:[0,0,60,60]},{name:"stone",rect:[60,0,60,60]},{name:"dirt",rect:[120,0,60,60]},{name:"default",rect:[180,0,60,60]},{name:"stone2",rect:[0,60,60,60]},{name:"wood",rect:[60,60,60,60]},{name:"sand",rect:[120,60,60,60]}]},tiles:[["default",2,6],["default",3,6],["default",4,6],["default",5,6],["default",6,6],["default",7,6],["default",8,6],["default",9,6],["default",10,6],["default",11,6],["default",12,6],["default",13,6],["default",14,6],["default",15,6],["default",16,6],["default",17,6],["default",18,6],["default",19,6],["default",26,6],["default",27,6],["default",28,6],["default",29,6],["default",30,6],["default",31,6],["default",32,6],["default",38,4],["default",39,4],["default",40,4],["default",41,4],["default",42,4],["default",43,4],["default",44,4],["default",45,4],["default",46,4],["default",47,4],["default",51,4],["default",52,4],["default",53,4],["default",55,6],["default",56,6],["wood",60,6],["default",64,8],["default",65,8],["default",66,8],["default",67,8],["default",68,8],["default",74,5],["default",75,5],["default",76,5],["default",77,5],["default",78,5],["default",79,5],["default",80,5],["default",81,5],["default",82,5],["default",87,8],["default",88,8],["default",93,6],["default",94,6],["default",95,6],["default",96,6],["default",101,6],["default",102,6],["default",103,6],["default",104,6],["default",105,6],["default",106,6],["default",107,6],["default",108,6],["default",109,6],["default",110,6],["default",111,6],["default",112,6],["default",113,6],["default",114,6],["default",115,6],["default",116,6],["default",117,6],["default",118,6],["default",119,6],["default",124,6],["default",125,6],["default",126,6],["default",127,6],["default",128,6],["default",129,6],["default",130,6],["default",131,6],["default",132,6],["default",133,6],["default",138,4],["default",139,4],["default",140,4],["default",141,4],["default",142,4],["default",143,4],["default",144,4],["default",145,4],["default",146,4],["default",147,4],["default",151,4],["default",152,4],["default",155,6],["default",156,6],["wood",160,6],["default",164,8],["default",165,8],["default",166,8],["default",167,8],["default",168,8],["default",173,5],["default",174,5],["default",175,5],["default",176,5],["default",177,5],["default",178,5],["default",179,5],["default",180,5],["default",181,5],["default",182,5],["default",187,8],["default",188,8],["default",194,6],["default",195,6],["dirt",195,7],["default",196,6],["dirt",196,7],["dirt",196,8],["default",197,6],["dirt",197,7],["dirt",197,8],["stone",197,9],["default",198,6],["dirt",198,7],["dirt",198,8],["stone",198,9],["default",199,6],["dirt",199,7],["dirt",199,8],["stone",199,9],["default",200,6],["dirt",200,7],["dirt",200,8],["stone",200,9],["default",201,6],["dirt",201,7],["dirt",201,8],["stone",201,9],["default",202,6],["dirt",202,7],["dirt",202,8],["stone",202,9],["default",203,6],["dirt",203,7],["dirt",203,8],["stone",203,9],["default",204,6],["dirt",204,7],["dirt",204,8],["stone",204,9],["default",205,6],["dirt",205,7],["dirt",205,8],["stone",205,9],["default",206,6],["dirt",206,7],["dirt",206,8],["stone",206,9],["default",207,6],["dirt",207,7],["dirt",207,8],["stone",207,9],["default",208,6],["dirt",208,7],["dirt",208,8],["stone",208,9],["default",209,6],["dirt",209,7],["dirt",209,8],["stone",209,9],["default",210,6],["dirt",210,7],["dirt",210,8],["stone",210,9],["default",211,6],["dirt",211,7],["dirt",211,8],["stone",211,9],["default",212,6],["dirt",212,7],["dirt",212,8],["stone",212,9],["default",213,6],["dirt",213,7],["dirt",213,8],["stone",213,9],["default",214,6],["dirt",214,7],["dirt",214,8],["stone",214,9],["default",215,6],["dirt",215,7],["dirt",215,8],["stone",215,9],["default",216,6],["dirt",216,7],["dirt",216,8],["stone",216,9],["default",217,6],["dirt",217,7],["dirt",217,8],["stone",217,9],["default",218,6],["dirt",218,7],["dirt",218,8],["stone",218,9],["default",219,6],["dirt",219,7],["dirt",219,8],["stone",219,9],["default",220,6],["dirt",220,7],["dirt",220,8],["stone",220,9],["default",221,6],["dirt",221,7],["dirt",221,8],["stone",221,9],["default",222,6],["dirt",222,7],["dirt",222,8],["stone",222,9],["default",223,6],["dirt",223,7],["dirt",223,8],["stone",223,9],["default",224,6],["dirt",224,7],["dirt",224,8],["stone",224,9],["default",225,6],["dirt",225,7],["dirt",225,8],["stone",225,9],["default",226,6],["dirt",226,7],["dirt",226,8],["default",227,6],["dirt",227,7],["default",228,6]],entities:[{name:"speedBooster",pos:[769.6654805148739,299.5]},{name:"rainbow",pos:[1314.8304345700217,43.5]},{name:"enemy",skinName:"cactus",pos:[1796,285.75]},{name:"enemy",skinName:"cactus",pos:[2580,0]},{name:"rainbow",pos:[3183.8893762925363,-147.088566603083]},{name:"enemy",skinName:"cactus",pos:[3968,405.75]},{name:"rainbow",pos:[4610,-7]},{name:"enemy",skinName:"cactus",pos:[4620,0]},{name:"rainbow",pos:[5604,37]},{name:"enemy",skinName:"cactus",pos:[6519.332364340603,285]},{name:"speedBooster",pos:[6663.277780038607,302.5]},{name:"rainbow",pos:[7388,0]},{name:"enemy",skinName:"cactus",pos:[7721.990176118361,286]},{name:"enemy",skinName:"cactus",pos:[9995.156915549245,408]}]};function l(){let t=!1;return(d,a)=>{const u=d.playerEnv.playerController.player,l=Math.abs(u.pos.x-500)<10;!t&&l&&(t=!0,(0,e.splash)("press space to jump",{size:50,timeout:2e3}))}}exports.default=(0,d.defineLevel)(u,{onStart:(e,t)=>{},afterUpdate:l()});
},{"../Splash":13,"../Traits":52,"./defineLevel":88,"../math":24,"../../img/backgrounds/clouds.png":84,"../../img/backgrounds/mountains.png":85,"../../img/backgrounds/forest.png":86,"../../sounds/hooked-on-a-feeling.mp3":83,"../../img/tiles/y5lxj.png":87}],79:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o=require("../Splash"),e=require("../Traits"),t=require("./defineLevel"),d=require("../math");const a={name:"shooting",spawn:[96,64],background:{images:{sky:require("../../img/backgrounds/clouds.png"),back:require("../../img/backgrounds/mountains.png"),front:require("../../img/backgrounds/forest.png")},gradient:o=>[["#256bcc",0],["#2278c6",(0,d.clamp)(.4-1e-4*o.y,0,.8)],["#00c7a4",.8]]},sounds:[{url:require("../../sounds/hooked-on-a-feeling.mp3"),name:"music"}],tileSprite:{imageURL:require("../../img/tiles/y5lxj.png"),tileW:60,tileH:60,frames:[{name:"grass",rect:[0,0,60,60]},{name:"stone",rect:[60,0,60,60]},{name:"dirt",rect:[120,0,60,60]},{name:"default",rect:[180,0,60,60]},{name:"stone2",rect:[0,60,60,60]},{name:"wood",rect:[60,60,60,60]},{name:"sand",rect:[120,60,60,60]}]},tiles:[["default",1,7],["default",2,7],["default",3,7],["default",4,7],["default",5,7],["default",6,7],["default",7,7],["default",8,7],["default",9,7],["default",10,7],["default",11,7],["default",12,7],["default",13,7],["default",14,7],["default",15,7],["default",16,7],["wood",17,6],["default",17,7],["wood",18,5],["wood",18,6],["default",18,7],["wood",24,5],["wood",24,6],["wood",24,7],["default",24,8],["wood",25,6],["wood",25,7],["default",25,8],["wood",26,7],["default",26,8],["default",27,8],["default",28,8],["default",29,8],["default",30,8],["default",31,8],["default",32,8],["default",33,8],["default",34,8],["default",35,8],["default",36,8],["default",37,8],["default",38,8],["default",39,8],["wood",46,7],["wood",47,7],["wood",48,7],["wood",49,7],["wood",50,7],["wood",51,7],["wood",52,7],["wood",53,6],["wood",53,7],["wood",54,6],["wood",55,6],["wood",56,6],["wood",57,6],["wood",58,6],["wood",59,6],["wood",60,5],["wood",60,6],["wood",61,5],["wood",62,5],["wood",63,5],["wood",64,5],["wood",65,5],["wood",66,4],["wood",66,5],["wood",67,4],["wood",68,4],["wood",69,4],["wood",70,4],["wood",71,4],["wood",72,4],["wood",73,4],["wood",74,4],["wood",75,4],["wood",76,4],["wood",77,4],["wood",78,4],["wood",79,4],["wood",80,-10],["wood",80,-9],["wood",80,-8],["wood",80,-7],["wood",80,-6],["wood",80,-5],["wood",80,-4],["wood",80,-3],["wood",80,4],["wood",81,4],["wood",82,-10],["wood",82,-9],["wood",82,-8],["wood",82,-7],["wood",82,-6],["wood",82,-5],["wood",82,-4],["wood",82,-3],["wood",82,4],["default",83,-4],["wood",83,-3],["wood",83,4],["default",84,-3],["wood",84,-2],["wood",84,4],["wood",84,5],["wood",84,6],["wood",84,7],["wood",84,8],["wood",84,9],["default",85,-3],["wood",85,-2],["default",85,5],["dirt",85,6],["dirt",85,7],["stone",85,8],["stone",85,9],["default",86,-3],["wood",86,-2],["default",86,6],["dirt",86,7],["stone",86,8],["stone",86,9],["default",87,-2],["wood",87,-1],["default",87,6],["dirt",87,7],["stone",87,8],["stone",87,9],["default",88,-1],["wood",88,0],["default",88,6],["dirt",88,7],["stone",88,8],["stone",88,9],["default",89,0],["wood",89,1],["default",89,6],["dirt",89,7],["stone",89,8],["stone",89,9],["default",90,1],["wood",90,2],["default",90,6],["dirt",90,7],["stone",90,8],["stone",90,9],["default",91,1],["wood",91,2],["default",91,6],["dirt",91,7],["stone",91,8],["stone",91,9],["default",92,6],["dirt",92,7],["stone",92,8],["stone",92,9],["default",93,6],["dirt",93,7],["stone",93,8],["stone",93,9],["dirt",94,7],["stone2",94,8],["stone",94,9],["stone2",95,8],["stone2",95,9],["stone2",96,9],["stone2",97,9],["stone2",98,9],["stone2",99,9],["stone2",100,9],["stone2",101,9],["wood",102,4],["stone2",102,9],["wood",103,4],["wood",103,5],["stone2",103,9],["stone2",104,9],["stone2",105,9],["stone2",106,9],["stone2",107,9],["stone2",108,9],["stone2",109,9],["stone2",110,9],["default",118,5],["default",119,5],["default",120,5],["default",121,5],["dirt",121,6],["default",122,6],["dirt",122,7],["default",123,7],["dirt",123,8],["default",124,8],["default",125,8],["default",126,8],["default",127,8],["default",128,8],["default",129,8],["default",130,8],["default",131,8],["default",132,8],["default",133,8],["wood",134,2],["default",134,8],["default",135,8],["default",136,8],["default",137,8],["default",138,8],["default",139,8],["default",140,8],["default",141,8],["default",142,8],["default",143,8],["default",144,8],["default",145,8],["stone2",146,5],["stone2",146,8],["dirt",146,9],["stone2",147,4],["stone2",147,5],["stone2",147,8],["dirt",147,9],["stone2",148,4],["stone2",148,8],["dirt",148,9],["wood",149,3],["stone2",149,4],["stone2",149,8],["dirt",149,9],["wood",150,3],["stone2",150,4],["stone2",150,8],["dirt",150,9],["stone2",151,4],["stone2",151,8],["dirt",151,9],["wood",152,3],["stone2",152,4],["stone2",152,8],["dirt",152,9],["stone2",153,4],["stone2",153,8],["dirt",153,9],["stone2",154,3],["stone2",154,4],["stone2",154,8],["dirt",154,9],["wood",155,2],["stone2",155,3],["stone2",155,4],["stone2",155,8],["dirt",155,9],["stone2",156,3],["stone2",156,4],["stone2",156,8],["dirt",156,9],["stone2",157,4],["stone2",157,8],["dirt",157,9],["stone2",158,4],["stone2",158,8],["dirt",158,9],["wood",159,3],["stone2",159,4],["stone2",159,8],["dirt",159,9],["stone2",160,4],["stone2",160,5],["stone2",160,8],["dirt",160,9],["stone2",161,5],["stone2",161,8],["dirt",161,9],["grass",162,8],["dirt",162,9],["stone2",163,8],["dirt",163,9],["grass",164,8],["dirt",164,9],["stone2",165,8],["dirt",165,9],["wood",166,7],["grass",166,8],["dirt",166,9],["stone2",167,8],["dirt",167,9],["grass",168,8],["dirt",168,9],["stone2",169,8],["dirt",169,9],["grass",170,8],["dirt",170,9],["stone2",171,8],["dirt",171,9],["wood",172,7],["stone2",172,8],["dirt",172,9],["wood",173,6],["wood",173,7],["grass",173,8],["dirt",173,9],["wood",174,7],["grass",174,8],["dirt",174,9],["stone2",175,8],["dirt",175,9],["grass",176,8],["dirt",176,9],["stone2",177,8],["dirt",177,9],["grass",178,8],["dirt",178,9],["stone2",179,8],["dirt",179,9],["grass",180,8],["dirt",180,9],["wood",181,7],["default",181,8],["dirt",181,9],["wood",182,7],["default",182,8],["dirt",182,9],["default",183,8],["dirt",183,9],["default",184,8],["dirt",184,9],["default",185,8],["dirt",185,9],["default",186,8],["dirt",186,9],["default",187,8],["dirt",187,9],["default",188,8],["dirt",188,9],["default",189,8],["dirt",189,9],["default",190,8],["dirt",190,9],["default",191,8],["dirt",191,9],["default",192,8],["dirt",192,9],["default",193,8],["dirt",193,9],["wood",198,8],["wood",199,7],["wood",203,7],["wood",204,6],["wood",207,6],["wood",208,5],["wood",211,5],["wood",212,4],["wood",214,5],["wood",215,4],["wood",218,5],["wood",219,4],["wood",220,4],["wood",221,4],["wood",222,4],["wood",223,4],["wood",224,4],["wood",225,4],["wood",226,4],["wood",227,4],["wood",228,4],["wood",229,4],["wood",230,4],["wood",231,4],["wood",232,4],["wood",233,4],["wood",234,4],["wood",235,4],["wood",236,4],["wood",237,4],["wood",238,4],["wood",239,4],["wood",240,4],["wood",241,4],["wood",242,4],["wood",243,4],["wood",244,4],["wood",245,3],["wood",245,4],["wood",246,3],["wood",247,2],["wood",247,3],["wood",247,4],["wood",247,5],["wood",247,6],["wood",247,7],["wood",247,8],["wood",247,9],["wood",247,10]],entities:[{name:"manaPot",pos:[1266.0000186093064,15]},{name:"enemy",pos:[2319.1666666666615,381.5],skinName:"target"},{name:"manaPot",pos:[2867,344]},{name:"manaPot",pos:[3017.408459114388,346]},{name:"manaPot",pos:[3283.9999999999914,285]},{name:"manaPot",pos:[3430.9999999999914,287]},{name:"manaPot",pos:[3664.050762163021,227]},{name:"manaPot",pos:[3805.050762163021,228]},{name:"speedBooster",pos:[4028.498282284062,177.5]},{name:"speedBooster",pos:[4781.498282284062,62.5]},{name:"enemy",skinName:"cactus",pos:[4858.074896158258,165.5]},{name:"enemy",skinName:"cactus",pos:[4859,-14.5]},{name:"enemy",skinName:"cactus",pos:[4859,108.5]},{name:"enemy",skinName:"cactus",pos:[4859,-398.5]},{name:"enemy",skinName:"cactus",pos:[4859,45.91666666666667]},{name:"enemy",skinName:"cactus",pos:[4859.074896158258,-210]},{name:"enemy",skinName:"cactus",pos:[4860,-463.08333333333337]},{name:"enemy",skinName:"cactus",pos:[4860,-74.5]},{name:"enemy",skinName:"cactus",pos:[4860.074896158258,-143.5]},{name:"enemy",skinName:"cactus",pos:[4860.074896158258,-275]},{name:"enemy",skinName:"cactus",pos:[4860.074896158258,-335]},{name:"enemy",pos:[4860.597505721113,-579.5],skinName:"cactus"},{name:"enemy",skinName:"cactus",pos:[4861,-519.5]},{name:"enemy",skinName:"cactus",pos:[4861,-641.75]},{name:"rainbow",pos:[4952.685545762244,35.5]},{name:"enemy",skinName:"cactus",pos:[5618.503676392036,289]},{name:"enemy",skinName:"cactus",pos:[5640.333333333396,341]},{name:"enemy",skinName:"cactus",pos:[5700.333333333396,402]},{name:"enemy",skinName:"cactus",pos:[5760.333333333396,461]},{name:"enemy",skinName:"cactus",pos:[5815.333333333396,467]},{name:"enemy",skinName:"cactus",pos:[5875.333333333396,468]},{name:"enemy",skinName:"cactus",pos:[5939.958719207056,467]},{name:"enemy",pos:[6104,167],skinName:"cactus"},{name:"rainbow",pos:[6826.5,229.5],skinName:"default"},{name:"manaPot",pos:[7065.899479945025,228],skinName:"default"},{name:"manaPot",pos:[7180.193362357293,228],skinName:"default"},{name:"enemy",pos:[8018.1666666666615,25],skinName:"target",id:"target-1"},{name:"enemy",pos:[8324.672259524485,385],skinName:"target",id:"target-2"},{name:"enemy",pos:[8726.672259524486,206],skinName:"target",id:"target-3"},{name:"door",pos:[8760.666972841413,315.5],skinName:"default",id:"door-1"},{name:"speedBooster",pos:[8801.896812757153,399.5],skinName:"default"},{name:"enemy",pos:[9664,406.5],skinName:"cactus"},{name:"manaPot",pos:[10194.166666849957,166],skinName:"default"},{name:"rainbow",pos:[10629.001220181868,11.253143575674308],skinName:"default"},{name:"manaPot",pos:[10978.166666849957,415],skinName:"default"},{name:"manaPot",pos:[11374.166666849957,398],skinName:"default"},{name:"enemy",pos:[12219.166666849957,265.5],skinName:"target"},{name:"rainbow",pos:[12329.157294348368,44.5],skinName:"default"},{name:"enemy",pos:[12459.166666849957,207.5],skinName:"target"},{name:"enemy",pos:[12880.166666849957,145.5],skinName:"target"},{name:"rainbow",pos:[13292.660758604594,-23.47985891352434],skinName:"default"}]};function n(){const o=s();return{onStart:(o,e)=>{},afterUpdate:(e,t)=>{o(e,t),i(e,t)}}}function s(){let e=!1;return(t,d)=>{const a=t.playerEnv.playerController.player,n=Math.abs(a.pos.x-1200)<10;!e&&n&&(e=!0,(0,o.splash)("press f to fire",{size:50,timeout:2e3}))}}function i(o,e){const t=e.namedEntities.get("door-1");t.behavior.opened||["target-1","target-2","target-3"].every(o=>{return e.namedEntities.get(o).killable.dead})&&t.behavior.open()}exports.default=(0,t.defineLevel)(a,n());
},{"../Splash":13,"../Traits":52,"./defineLevel":88,"../math":24,"../../img/backgrounds/clouds.png":84,"../../img/backgrounds/mountains.png":85,"../../img/backgrounds/forest.png":86,"../../sounds/hooked-on-a-feeling.mp3":83,"../../img/tiles/y5lxj.png":87}],80:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../Splash"),t=require("../Traits"),d=require("./defineLevel"),a=require("../math");const u={name:"haste",spawn:[96,64],background:{images:{sky:require("../../img/backgrounds/clouds.png"),back:require("../../img/backgrounds/mountains.png"),front:require("../../img/backgrounds/forest.png")},gradient:e=>[["#256bcc",0],["#2278c6",(0,a.clamp)(.4-1e-4*e.y,0,.8)],["#00c7a4",.8]]},sounds:[{url:require("../../sounds/hooked-on-a-feeling.mp3"),name:"music"}],tileSprite:{imageURL:require("../../img/tiles/y5lxj.png"),tileW:60,tileH:60,frames:[{name:"grass",rect:[0,0,60,60]},{name:"stone",rect:[60,0,60,60]},{name:"dirt",rect:[120,0,60,60]},{name:"default",rect:[180,0,60,60]},{name:"stone2",rect:[0,60,60,60]},{name:"wood",rect:[60,60,60,60]},{name:"sand",rect:[120,60,60,60]}]},tiles:[["default",1,7],["default",2,7],["default",3,7],["default",4,7],["default",5,7],["default",6,7],["default",7,7],["default",8,7],["default",9,7],["default",10,7],["default",11,7],["default",12,7],["default",13,7],["default",14,7],["default",15,7],["default",16,7],["default",17,7],["default",18,7],["default",19,7],["default",20,7],["default",21,7],["default",22,7],["default",23,7],["default",24,7],["default",25,7],["default",26,7],["default",40,7],["default",41,7],["default",42,7],["default",43,7],["default",44,7],["default",45,7],["default",46,7],["default",47,7],["default",48,7],["default",49,7],["default",50,7],["wood",61,2],["wood",62,2],["wood",63,2],["wood",68,1],["wood",69,1],["wood",70,1],["wood",71,1],["wood",72,1],["wood",73,1],["wood",84,3],["default",84,4],["dirt",84,5],["dirt",84,6],["wood",85,4],["default",85,5],["dirt",85,6],["default",86,6],["default",87,6],["default",88,6],["default",89,6],["default",90,6],["default",91,6],["default",92,6],["default",93,6],["default",94,6],["default",95,6],["default",96,6],["default",97,6],["default",98,6],["default",99,6],["default",100,6],["default",101,6],["default",102,6],["default",103,6],["default",104,6],["default",105,6],["default",106,6],["default",107,6],["default",108,6],["default",109,6],["default",110,6],["default",111,6],["default",112,6],["default",113,6],["default",114,6],["default",115,6],["default",116,6],["default",117,6],["default",118,6],["default",119,6],["default",120,6],["default",121,6],["default",122,6],["default",123,6],["default",124,6],["default",125,6],["default",126,6],["default",127,6],["default",128,6],["default",129,6],["stone2",145,2],["stone2",146,2],["stone2",147,2],["wood",154,4],["wood",155,4],["wood",156,4],["wood",157,4],["wood",158,4],["wood",165,2],["wood",166,2],["wood",167,2],["wood",168,2],["wood",169,2],["wood",176,0],["wood",177,0],["wood",178,0],["wood",179,0],["wood",183,2],["wood",184,2],["wood",185,2],["wood",186,2],["wood",187,2],["wood",191,9],["wood",192,9],["wood",193,9],["wood",197,9],["wood",198,9],["wood",199,9],["wood",200,9],["wood",201,9],["wood",202,9],["wood",207,9],["wood",212,6],["wood",216,5],["wood",220,4],["wood",224,3],["wood",228,3],["wood",232,3],["wood",236,3],["wood",238,4],["wood",240,5],["default",242,6],["default",243,6],["default",244,6],["default",245,6],["default",246,6],["default",247,6],["default",248,6],["default",249,6],["default",250,6],["default",251,6],["default",252,6],["default",253,6],["default",254,6],["default",255,6],["default",256,6],["default",257,6],["default",258,6],["default",259,6],["default",260,6],["default",261,6],["default",262,6],["default",263,6],["default",264,6],["default",267,6],["default",268,6],["default",269,6],["default",270,6],["default",271,6],["default",272,6],["default",273,6],["default",274,6],["default",275,6],["default",276,6],["default",279,6],["default",280,6],["default",281,6],["default",282,6],["default",283,6],["default",284,6],["default",285,6],["default",286,6],["default",287,6],["default",288,6],["default",289,6],["default",290,6],["default",291,6],["default",294,6],["default",295,6],["default",296,6],["default",297,6],["default",298,6],["default",299,6],["default",300,6],["default",301,6],["default",302,6],["default",304,6],["default",305,6],["default",306,6],["default",309,6],["default",310,6],["default",311,6],["default",312,6],["default",315,6],["default",316,6],["default",317,6],["default",318,6],["default",319,6],["default",320,6],["default",321,6],["default",322,6],["default",323,6],["default",324,6],["default",327,6],["default",328,6],["default",331,6],["default",332,6],["default",333,6],["default",334,6],["default",336,6],["default",337,6],["default",338,6],["default",339,6],["default",340,6],["default",341,6],["default",343,6],["default",344,6],["default",345,6],["default",346,6],["default",347,6],["default",349,6],["default",350,6],["default",351,6],["default",352,6],["default",353,6],["default",354,6],["default",355,6],["default",356,6],["default",357,6],["default",358,6],["default",359,6],["stone2",362,4],["stone2",362,5],["stone2",362,6],["wood",363,5],["stone2",363,6],["stone2",364,6],["wood",365,5],["stone2",365,6],["stone2",366,4],["stone2",366,5],["stone2",366,6],["wood",367,5],["stone2",367,6],["stone2",368,6],["wood",369,5],["stone2",369,6],["stone2",370,4],["stone2",370,5],["stone2",370,6],["wood",371,5],["stone2",371,6],["stone2",372,6],["wood",373,5],["stone2",373,6],["stone2",374,4],["stone2",374,5],["stone2",374,6],["wood",375,5],["stone2",375,6],["stone2",376,6],["wood",377,5],["stone2",377,6],["stone2",378,4],["stone2",378,5],["stone2",378,6],["dirt",383,6],["default",384,3],["dirt",384,4],["dirt",384,6],["default",385,2],["dirt",385,3],["dirt",385,4],["dirt",385,6],["default",386,2],["dirt",386,3],["dirt",386,4],["dirt",386,6],["default",388,3],["dirt",388,4],["dirt",388,6],["default",389,2],["dirt",389,3],["dirt",389,4],["dirt",389,6],["default",390,2],["dirt",390,3],["dirt",390,6],["default",391,1],["dirt",391,2],["dirt",391,6],["default",392,1],["dirt",392,2],["dirt",392,3],["dirt",392,4],["dirt",392,5],["dirt",392,6],["default",393,1],["dirt",393,2],["dirt",393,3],["dirt",393,4],["dirt",393,5],["dirt",393,6],["default",394,0],["dirt",394,1],["dirt",394,2],["dirt",394,3],["dirt",394,4],["dirt",394,6],["default",395,0],["dirt",395,1],["dirt",395,6],["default",396,0],["dirt",396,1],["dirt",396,4],["dirt",396,6],["default",397,0],["dirt",397,1],["dirt",397,4],["dirt",397,5],["dirt",397,6],["default",398,0],["dirt",398,1],["dirt",398,4],["dirt",398,5],["dirt",398,6],["default",399,0],["dirt",399,1],["dirt",399,4],["dirt",399,5],["default",400,0],["dirt",400,1],["dirt",400,4],["dirt",400,5],["dirt",400,6],["dirt",401,2],["dirt",401,4],["dirt",401,5],["dirt",401,6],["dirt",402,2],["dirt",402,3],["dirt",402,4],["dirt",402,5],["dirt",403,4],["default",404,-1],["dirt",404,0],["dirt",404,1],["dirt",404,4],["default",405,-1],["dirt",405,0],["dirt",405,4],["default",406,-1],["dirt",406,0],["dirt",406,1],["dirt",406,4],["dirt",407,1],["dirt",407,2],["dirt",407,3],["dirt",407,4],["dirt",408,3],["dirt",408,4],["default",409,-2],["dirt",409,-1],["dirt",409,0],["dirt",409,4],["default",410,-2],["dirt",410,-1],["dirt",410,0],["dirt",410,4],["default",411,-1],["dirt",411,0],["dirt",411,1],["dirt",411,2],["dirt",411,3],["dirt",411,4],["dirt",411,5],["default",412,0],["dirt",412,1],["dirt",412,2],["dirt",412,3],["dirt",412,6],["default",413,0],["dirt",413,1],["dirt",413,6],["default",414,0],["dirt",414,1],["dirt",414,5],["default",415,1],["dirt",415,2],["dirt",415,3],["dirt",415,4],["dirt",415,5]],entities:[{name:"manaPot",pos:[485.6330162237009,348],skinName:"default"},{name:"manaPot",pos:[605.6383789811518,348],skinName:"default"},{name:"speedBooster",pos:[2812.2347522228215,355.5],skinName:"default"},{name:"rainbow",pos:[4137.700972128387,-281.40700721319774],skinName:"default"},{name:"manaPot",pos:[4173.970876438694,-15.806867394646929],skinName:"default"},{name:"speedBooster",pos:[4355.470876438694,-1.306867394646929],skinName:"default"},{name:"manaPot",pos:[5423.255953223659,291],skinName:"default"},{name:"speedBooster",pos:[5706.755953223659,298.5],skinName:"default"},{name:"manaPot",pos:[5873.255953223659,289],skinName:"default"},{name:"speedBooster",pos:[6187.755953223659,288.5],skinName:"default"},{name:"manaPot",pos:[6463.255953223659,282],skinName:"default"},{name:"speedBooster",pos:[6769.755953223659,301.5],skinName:"default"},{name:"manaPot",pos:[7057.255953223659,286],skinName:"default"},{name:"rainbow",pos:[9023.31340703079,-143.56851863088718],skinName:"default"},{name:"rainbow",pos:[11116.838169488621,-432.3583991660562],skinName:"default"},{name:"manaPot",pos:[13550.334932109752,64],skinName:"default"},{name:"manaPot",pos:[13795.334932109752,70],skinName:"default"},{name:"manaPot",pos:[14045.334932109752,65],skinName:"default"},{name:"rainbow",pos:[14492.279191459636,-110.14351629708781],skinName:"default"},{name:"speedBooster",pos:[14782.741349921134,303.5],skinName:"default"},{name:"speedBooster",pos:[14979.741349921134,305.5],skinName:"default"},{name:"speedBooster",pos:[15148.741349921134,303.5],skinName:"default"},{name:"speedBooster",pos:[15301.741349921134,301.5],skinName:"default"},{name:"speedBooster",pos:[15432.741349921134,298.5],skinName:"default"},{name:"speedBooster",pos:[15588.741349921134,299.5],skinName:"default"},{name:"speedBooster",pos:[15734.741349921134,301.5],skinName:"default"},{name:"speedBooster",pos:[16009.741349921134,292.5],skinName:"default"},{name:"enemy",pos:[17111.241349921132,276.5],skinName:"cactus"},{name:"enemy",pos:[17836.241349921132,281.5],skinName:"cactus"},{name:"enemy",pos:[19095.241349921132,264.5],skinName:"target"}]};function l(){const e=f();return{onStart:(e,t)=>{},afterUpdate:(t,d)=>{e(t,d)}}}function f(){let t=!1;return(d,a)=>{const u=d.playerEnv.playerController.player,l=Math.abs(u.pos.x-500)<10;!t&&l&&(t=!0,(0,e.splash)("press shift to boost",{size:50,timeout:2e3}))}}exports.default=(0,d.defineLevel)(u,l());
},{"../Splash":13,"../Traits":52,"./defineLevel":88,"../math":24,"../../img/backgrounds/clouds.png":84,"../../img/backgrounds/mountains.png":85,"../../img/backgrounds/forest.png":86,"../../sounds/hooked-on-a-feeling.mp3":83,"../../img/tiles/y5lxj.png":87}],64:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./demo"),r=f(e),t=require("./one"),u=f(t),d=require("./two"),l=f(d),o=require("./three"),a=f(o);function f(e){return e&&e.__esModule?e:{default:e}}exports.default=[r.default,u.default,l.default,a.default];
},{"./demo":77,"./one":78,"./two":79,"./three":80}],9:[function(require,module,exports) {
"use strict";var e,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.LevelManager=exports.LevelEvents=void 0;var l=require("./levels"),s=h(l),i=require("./Splash"),a=require("./util");function h(e){return e&&e.__esModule?e:{default:e}}const r={IDLE:Symbol("IDLE"),FAILED:Symbol("FAILED"),FINISH_ANIMATION:Symbol("FINISH_ANIMATION"),FINISHED:Symbol("FINISHED")},n=exports.LevelEvents={FAILED:Symbol("FAILED"),FINISHED:Symbol("FINISHED")};let o=exports.LevelManager=(e=a.EventEmitter.decorator)(t=class{constructor(e){this.game=e;let t=0;this.levels=s.default,this.levelIdx=t,this.levelState=r.IDLE,this.level=void 0,this.stopLevel=void 0,this.showSplash=!0,this.finishDistance=1500,this.fallDistance=600,this.levelSelector=document.getElementById("current-level")}get playerController(){return this.game.playerEnv.playerController}get player(){return this.game.playerEnv.playerController.player}async restartLevel(){return this.runLevel(this.levelIdx)}async nextLevel(){return this.levelIdx+=1,this.runLevel(this.levelIdx)}async runLevel(e=this.levelIdx){this.stopLevel&&this.stopLevel(),localStorage.setItem("levelIdx",e),this.game.canvasSelector.classList.toggle("black",!0),this.levelIdx=e,this.levelSelector.innerHTML=e;const{init:t}=this.levels[e],{level:l,startLevel:s,stopLevel:a}=await t(this.game);return this.level=l,this.stopLevel=a,this.showSplash&&l.name&&await(0,i.splash)(l.name),this.game.canvasSelector.classList.toggle("black",!1),s(),this.levelState=r.IDLE,l}update(e){this.level&&(this.level.frozen||this.levelState!==r.FINISHED&&([r.FINISH_ANIMATION,r.IDLE].includes(this.levelState)&&this.checkFinished(),this.levelState===r.IDLE&&this.checkFailed()))}checkFinished(){if(!(this.level.distance-this.player.pos.x>this.finishDistance))return this.player.pos.y+this.player.size.y<-500?(this.levelState=r.FINISHED,void this.onFinish()):void(this.levelState===r.IDLE&&(this.levelState=r.FINISH_ANIMATION,this.ufo=this.game.entityFactory.ufo({napEntity:this.player}),this.level.entities.add(this.ufo),this.game.cameraController.focus.notice(this.ufo,1e4)))}checkFailed(){const e=this.player.killable.dead&&!this.level.entities.has(this.player),t=this.player.pos.y>this.fallDistance,l=e||t;t&&this.player.killable.kill(),l&&(this.onFail(),this.levelState=r.FAILED)}onFinish(){const e=this.levelIdx===this.levels.length-1;this.emit(n.FINISHED,{isLastLevel:e})}onFail(){this.emit(n.FAILED)}})||t;
},{"./levels":64,"./Splash":13,"./util":20}],47:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let t=exports.Sound=class{constructor(t,s,i){this.name=t,this.buffer=s,this.createSource=i,this.isPlaying=!1,this.timeoutId=void 0,this.source=void 0,this.gainNode=void 0}playOnce({rate:t=1,volume:s=.3}={}){const{gainNode:i,source:e}=this.createSource(this.buffer);this.gainNode=i,this.source=e,this.source.playbackRate.value=t,this.gainNode.gain.value=s,this.source.start(0),this.isPlaying=!0}playLoop({rate:t=1,volume:s=.3}={}){const{gainNode:i,source:e}=this.createSource(this.buffer,{loop:!0});this.gainNode=i,this.source=e,this.source.playbackRate.value=t,this.gainNode.gain.value=s,this.source.start(0),this.isPlaying=!0}startPlaying(t){const{gainNode:s,source:i}=this.createSource(this.buffer,t);this.gainNode=s,this.source=i,this.source.start(0),this.isPlaying=!0}stop(){this.source&&this.source.stop(),this.isPlaying=!1}playing({rate:t=1,volume:s=.3}={}){this.isPlaying||this.startPlaying({loop:!0,rate:t,volume:s}),this.source.playbackRate.value=t,this.gainNode.gain.value=s,this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.stop.bind(this),100)}};
},{}],45:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SoundContext=void 0;var e=require("./Sound");let t=class{constructor(){this.context=new AudioContext,document.addEventListener("mousemove",this.onMouseMove.bind(this))}onMouseMove(e){"suspended"===this.context.state&&this.context.resume()}loadBuffer(e){return fetch(e).then(e=>e.arrayBuffer()).then(e=>this.context.decodeAudioData(e))}async loadSounds(t){const o=new Map,n=await Promise.all(t.map(e=>this.loadBuffer(e.url)));return t.forEach((t,s)=>{const r=n[s];o.set(t.name,new e.Sound(t.name,r,this.createSource.bind(this)))}),o}createSource(e,{volume:t=.5,loop:o=!1,rate:n=1}={}){const s=this.context.createBufferSource(),r=this.context.createGain();return s.buffer=e,s.loop=void 0!==o&&o,s.playbackRate.value=void 0!==n?n:1,r.gain.value=t,s.connect(r),r.connect(this.context.destination),{source:s,gainNode:r}}};const o=exports.SoundContext=new t;
},{"./Sound":47}],46:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let t=exports.SpriteSheet=class{constructor(t,e,i,s){this.skinName=t||"default",this.image=e,this.width=i,this.height=s,this.tiles=new Map,this.animations=new Map}defineAnim(t,e){this.animations.set(t,e)}define(t,e,i,s,a){const h=[!1,!0].map(()=>{const t=document.createElement("canvas");return t.width=s,t.height=a,t.getContext("2d").drawImage(this.image,e,i,s,a,0,0,s,a),t});this.tiles.set(t,h)}draw(t,e,i,s){const a=this.tiles.get(t)[0];e.drawImage(a,i,s)}drawTile(t,e,i,s){this.draw(t,e,i*this.width,s*this.height)}};
},{}],23:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createAnim=r,exports.loadImage=o,exports.loadImages=s,exports.loadSpriteSheet=a,exports.loadSounds=i;var e=require("./SoundContext"),n=require("./SpriteSheet"),t=require("./Sound");function r(e,n){return function(t){const r=Math.floor(t/n)%e.length;return e[r]}}function o(e){return new Promise(n=>{const t=new Image;t.addEventListener("load",()=>{n(t)}),t.src=e})}function s(e){const n=Object.keys(e),t=Object.values(e);return Promise.all(t.map(e=>o(e))).then(e=>e.reduce((e,t,r)=>(e[n[r]]=t,e),{}))}function a(e){return Promise.resolve(e).then(e=>Promise.all([e,o(e.imageURL)])).then(([e,t])=>{const o=new n.SpriteSheet(e.skinName,t,e.tileW,e.tileH);return e.frames&&e.frames.forEach(e=>{o.define(e.name,...e.rect)}),e.animations&&e.animations.forEach(e=>{const n=r(e.frames,e.frameLen);o.defineAnim(e.name,n)}),o})}function i(n){return Promise.resolve(n).then(n=>Promise.all([n,e.SoundContext.loadSounds(n.sounds)])).then(([e,n])=>Object.assign(n,{skinName:e.skinName||"default"}))}
},{"./SoundContext":45,"./SpriteSheet":46,"./Sound":47}],53:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e};exports.defineGameObject=a;var t=require("./Entity"),s=require("./loaders");function n(e,t,s){const n=t(e);return function(t){e.draw(n(this),t,0,0,s)}}const o={spriteSpecs:[],soundSpecs:[],traits:void 0,animations:void 0,sounds:void 0,drawBounds:!1,afterCreate:void 0};function a(a,i){const{spriteSpecs:r,soundSpecs:d,traits:c,animations:u,sounds:f,drawBounds:l,afterCreate:p}=e({},o,i);return async()=>{const[o,i]=await Promise.all([Promise.all(r.map(e=>(0,s.loadSpriteSheet)(e))),Promise.all(d.map(e=>(0,s.loadSounds)(e)))]);function m(s={}){const d=s.skinName||"default";let m=o.find(e=>e.skinName===d),v=r.find(e=>e.skinName===d);const S=i.find(e=>e.skinName===d);m||(m=o[0],v=r[0]);const w=new t.Entity(a);w.size.set(v.size[0],v.size[1]),w.offset.x=v.offset[0],w.offset.y=v.offset[1],c(e({},s,{sounds:S})).forEach(e=>w.addTrait(e));const y=l?w.bounds.clone():void 0;return w.draw=n(m,u,y),w.voice=f?f(S):void 0,p&&p(w),w}return m.availableSkins=o.map(e=>e.skinName||"default"),m}}
},{"./Entity":37,"./loaders":23}],68:[function(require,module,exports) {
module.exports="559ecc53ce800c0f51b895b1ebef678f.png";
},{}],61:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={skinName:"cactus",imageURL:require("../../../img/enemies/cactus.png"),size:[50,51],offset:[5,21],frames:[{name:"idle-1",rect:[0,-8,61,73]},{name:"idle-2",rect:[62,-8,61,73]},{name:"idle-3",rect:[123,-8,61,73]},{name:"idle-4",rect:[184,-8,61,73]},{name:"idle-5",rect:[248,-7,61,73]},{name:"idle-6",rect:[314,-7,61,73]},{name:"attack-1",rect:[197,215,61,73]},{name:"attack-2",rect:[110,215,75,73]},{name:"attack-3",rect:[14,215,75,73]},{name:"death-1",rect:[197,216,63,73]},{name:"death-2",rect:[260,216,63,73]},{name:"death-3",rect:[323,216,63,73]},{name:"death-4",rect:[386,216,63,73]},{name:"death-5",rect:[449,216,63,73]},{name:"death-6",rect:[512,216,63,73]}],animations:[{name:"idle",frameLen:.2,frames:["idle-1","idle-2","idle-3","idle-4","idle-5","idle-6"]},{name:"attack",frameLen:.1,frames:["attack-1","attack-2","attack-3"]},{name:"death",frameLen:.1,frames:["death-1","death-2","death-3","death-4","death-5","death-6"]}]};
},{"../../../img/enemies/cactus.png":68}],67:[function(require,module,exports) {
module.exports="7bfdf12ae8085a901da695461086a7c6.png";
},{}],62:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={imageURL:require("../../../img/enemies/targets.png"),skinName:"target",size:[50,75],offset:[25,18],frames:[{name:"idle-1",rect:[0,0,91,104]},{name:"idle-2",rect:[91,0,91,104]},{name:"idle-3",rect:[182,0,91,104]},{name:"idle-4",rect:[273,0,91,104]},{name:"idle-5",rect:[364,0,91,104]},{name:"idle-6",rect:[455,0,91,104]},{name:"idle-7",rect:[455,104,91,104]},{name:"idle-8",rect:[364,104,91,104]},{name:"idle-9",rect:[273,104,91,104]},{name:"idle-10",rect:[182,104,91,104]},{name:"idle-11",rect:[91,104,91,104]},{name:"idle-12",rect:[0,104,91,104]},{name:"death-1",rect:[455,312,91,104]},{name:"death-2",rect:[364,312,91,104]},{name:"death-3",rect:[273,312,91,104]},{name:"death-4",rect:[182,312,91,104]},{name:"death-5",rect:[91,312,95,104]},{name:"death-6",rect:[0,312,95,104]}],animations:[{name:"idle",frameLen:.2,frames:["idle-1","idle-2","idle-3","idle-4","idle-5","idle-6","idle-7","idle-8","idle-9","idle-10","idle-11","idle-12"]},{name:"attack",frameLen:.1,frames:["death-1","death-2","death-3","death-4","death-5","death-6"]},{name:"death",frameLen:.1,frames:["death-1","death-2","death-3","death-4","death-5","death-6"]}]};
},{"../../../img/enemies/targets.png":67}],25:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadEnemy=void 0;var e=require("../Entity"),t=require("../loaders"),i=require("../Traits"),a=require("../defineGameObject"),s=require("./enemy_skins/enemy_cactus"),l=c(s),n=require("./enemy_skins/enemy_target"),r=c(n);function c(e){return e&&e.__esModule?e:{default:e}}let k=class extends e.Trait{constructor(){super("behavior"),this.attackDuration=.25,this.cancelAttackAfter=2,this.inAttack=!1,this.startAttackTime=0,this.attackTime=0}update(e,t,i){e.killable.dead?e.vel.x+=1e3:!this.inAttack||this.attackTime>this.attackDuration||(this.attackTime=e.lifetime-this.startAttackTime)}collides(e,t){t.killable&&!e.killable.dead&&e.name!==t.name&&(t.killable.kill(),this.inAttack||(this.inAttack=!0,this.startAttackTime=e.lifetime,setTimeout(()=>{this.inAttack=!1,this.attackTime=0,this.startAttackTime=0},1e3*this.cancelAttackAfter)))}};const m=exports.loadEnemy=(0,a.defineGameObject)("enemy",{spriteSpecs:[l.default,r.default],afterCreate:e=>{e.killable.removeAfter=.6},traits:({ownerEntity:e})=>[new i.Physics,new i.Solid,new i.Killable,new i.Stackable,new k],animations:e=>{const t=e.animations.get("idle"),i=e.animations.get("attack"),a=e.animations.get("death");return e=>e.behavior.inAttack?i(e.behavior.attackTime):e.killable.dead?a(e.killable.deadTime):t(e.lifetime)}});
},{"../Entity":37,"../loaders":23,"../Traits":52,"../defineGameObject":53,"./enemy_skins/enemy_cactus":61,"./enemy_skins/enemy_target":62}],69:[function(require,module,exports) {
module.exports="6913ad4532454b2a199119399f6dd859.png";
},{}],70:[function(require,module,exports) {
module.exports="67b38d0d44db1fb69c34a29462fa434c.wav";
},{}],71:[function(require,module,exports) {
module.exports="fa3e2bf7164ae937e89a42b41e3cb7f5.wav";
},{}],72:[function(require,module,exports) {
module.exports="287d525952d9a4e02bf017596997fe6f.wav";
},{}],73:[function(require,module,exports) {
module.exports="6ac39807292516b2d20924612f17b579.wav";
},{}],26:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadUnicorn=void 0;var e=require("../defineGameObject"),n=require("../Entity"),a=require("../Traits");const r={imageURL:require("../../img/unicorn.png"),skinName:"default",size:[90,100],offset:[45,40],frames:[{name:"idle",rect:[3956,0,172,142]},{name:"run-1",rect:[4128,0,172,142]},{name:"run-2",rect:[4300,0,172,142]},{name:"run-3",rect:[4472,0,172,142]},{name:"run-4",rect:[4644,0,172,142]},{name:"run-5",rect:[4816,0,172,142]},{name:"run-6",rect:[4988,0,172,142]},{name:"run-7",rect:[5160,0,172,142]},{name:"run-8",rect:[5332,0,172,142]},{name:"break",rect:[3956,0,172,142]},{name:"jump-1",rect:[3268,0,172,142]},{name:"jump-2",rect:[3440,0,172,142]},{name:"jump-3",rect:[3612,0,172,142]},{name:"jump-4",rect:[3784,0,172,142]},{name:"fall-1",rect:[4300,0,172,142]},{name:"fall-2",rect:[4472,0,172,142]},{name:"death-1",rect:[1376,0,172,142]},{name:"death-2",rect:[1548,0,172,142]},{name:"death-3",rect:[1720,0,172,142]},{name:"death-4",rect:[1892,0,172,142]},{name:"death-5",rect:[2064,0,172,142]},{name:"death-6",rect:[2236,0,172,142]},{name:"death-7",rect:[1376,0,172,142]},{name:"death-8",rect:[1376,0,172,142]},{name:"death-9",rect:[1376,0,172,142]},{name:"cast-1",rect:[0,0,172,142]},{name:"cast-2",rect:[172,0,172,142]},{name:"cast-3",rect:[344,0,172,142]},{name:"cast-4",rect:[516,0,172,142]},{name:"cast-5",rect:[688,0,172,142]},{name:"cast-6",rect:[860,0,172,142]}],animations:[{name:"run",frameLen:20,frames:["run-1","run-2","run-3","run-4","run-5","run-6","run-7","run-8"]},{name:"jump",frameLen:.2,frames:["jump-1","jump-2","jump-3","jump-4"]},{name:"fall",frameLen:.2,frames:["fall-1","fall-2"]},{name:"cast",frameLen:.1,frames:["cast-4"]},{name:"death",frameLen:.2,frames:["death-1","death-2","death-3","death-4","death-5","death-6","death-7","death-8","death-9"]}]},t={sounds:[{url:require("../../sounds/clip-clop.wav"),name:"clip-clop",loop:!0},{url:require("../../sounds/horse-die.wav"),name:"die"},{url:require("../../sounds/jump.wav"),name:"jump"},{url:require("../../sounds/land.wav"),name:"land"}]};function m(e){const n=e.animations.get("run"),a=e.animations.get("jump"),r=e.animations.get("fall"),t=e.animations.get("death"),m=e.animations.get("cast");return e=>e.killable.dead?t(e.killable.deadTime):e.striker.isStriking()?m(e.lifetime):e.jump.jumpingUp?a(e.jump.engageTime):e.run.lastSpeed<1e3?"idle":e.jump.fallingDown?r(e.jump.engageTime):e.run.distance>0?n(e.run.distance):"idle"}function i(e){const n=e.get("clip-clop"),a=e.get("die");return e=>{e.killable.dead?a.playing({volume:.1}):e.jump.jumpingUp||e.jump.fallingDown||e.run.distance>0&&n.playing({rate:e.run.realSpeed/1e4,volume:.02})}}const u=exports.loadUnicorn=(0,e.defineGameObject)("unicorn",{spriteSpecs:[r],soundSpecs:[t],traits:({speed:e})=>[new a.Physics,new a.Solid,new a.Run({speed:e||15e3}),new a.Jump,new a.Picker,new a.Killable({removeAfter:1}),new a.Striker,new a.Killer],animations:m,sounds:i});
},{"../defineGameObject":53,"../Entity":37,"../Traits":52,"../../img/unicorn.png":69,"../../sounds/clip-clop.wav":70,"../../sounds/horse-die.wav":71,"../../sounds/jump.wav":72,"../../sounds/land.wav":73}],50:[function(require,module,exports) {
module.exports="22f6db533a9af11e09f6f3561d96976d.png";
},{}],27:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadUfo=void 0;var t=require("../defineGameObject"),i=require("../Entity"),e=require("../Traits");const s={size:[240,350],offset:[0,0],skinName:"default",imageURL:require("../../img/ufo.png"),frames:[{name:"idle",rect:[0,0,240,350]}],animations:[{name:"idle",frameLen:.1,frames:["idle"]}]};let n=class extends i.Trait{constructor(t){super("ufoBehavior"),this.napEntity=t,this.catched=!1,this.catchTime=0,this.spawned=!1}spawn(){this.entity.pos.x=this.napEntity.pos.x-1500,this.spawned=!0}catch(t){this.catched=!0,this.catchTime=t,this.napEntity.removeTrait("solid"),this.napEntity.removeTrait("physics")}canCatch(){return this.entity.bounds.left+this.entity.bounds.width/2-(this.napEntity.bounds.left+this.napEntity.bounds.width/2)>0}abduct(){const t=this.entity.bounds.left+this.entity.bounds.width/2;this.entity.vel.y-=50,this.entity.vel.x>100&&(this.entity.vel.x-=100),this.napEntity.pos.x=t-this.napEntity.bounds.width/2,this.napEntity.pos.y=this.entity.bounds.bottom-this.napEntity.bounds.height}alignTarget(){this.entity.vel.x+=100,this.entity.bounds.bottom=this.napEntity.bounds.top+this.napEntity.bounds.height/2}update(t,i,e){this.spawned||e.frozen||this.spawn(),this.catched||(this.alignTarget(),this.canCatch()&&this.catch(i)),this.catched&&this.abduct()}};const a=exports.loadUfo=(0,t.defineGameObject)("ufo",{spriteSpecs:[s],traits:({napEntity:t})=>[new e.Physics({applyGravity:!1}),new n(t)],animations:t=>{const i=t.animations.get("idle");return t=>i(t.lifetime)}});
},{"../defineGameObject":53,"../Entity":37,"../Traits":52,"../../img/ufo.png":50}],66:[function(require,module,exports) {
module.exports="d45e0f965a71453d0f3b574045203e03.png";
},{}],58:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.MANA_BUBBLES_SPRITE={skinName:"default",size:[70,70],offset:[15,0],imageURL:require("../../img/pickables/mana_bubbles.png"),frames:[{name:"idle-1",rect:[0,300,95,60]},{name:"idle-2",rect:[95,300,95,60]},{name:"idle-3",rect:[190,300,95,60]},{name:"idle-4",rect:[285,300,95,60]},{name:"idle-5",rect:[380,300,95,60]},{name:"idle-6",rect:[0,400,95,60]},{name:"idle-7",rect:[95,400,95,60]},{name:"idle-8",rect:[190,400,95,60]},{name:"idle-9",rect:[285,400,95,60]},{name:"idle-10",rect:[380,400,95,60]},{name:"idle-11",rect:[0,500,95,60]},{name:"idle-12",rect:[95,500,95,60]},{name:"idle-13",rect:[190,500,95,60]},{name:"idle-14",rect:[285,500,95,60]},{name:"idle-15",rect:[380,500,95,60]}],animations:[{name:"idle",frameLen:.1,frames:["idle-1","idle-2","idle-3","idle-4","idle-5","idle-6","idle-7","idle-8","idle-9","idle-10","idle-11","idle-12","idle-13","idle-14","idle-15"]}]};
},{"../../img/pickables/mana_bubbles.png":66}],65:[function(require,module,exports) {
module.exports="0a1c25af6e83f370db42cefcc7ec131b.png";
},{}],59:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=exports.MANA_PYLON_SPRITE={size:[70,70],offset:[15,0],skinName:"pylon",imageURL:require("../../img/pickables/mana_pylon.png"),frames:Array.from(new Array(10)).map((e,a)=>({name:`idle-${a+1}`,rect:[45*a,72,45,53]})),animations:[{name:"idle",frameLen:.1,frames:["idle-1"]}]};
},{"../../img/pickables/mana_pylon.png":65}],51:[function(require,module,exports) {
module.exports="801a84ee4cca035d02cacad35faef296.wav";
},{}],28:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadManaPot=void 0;var e=require("../defineGameObject"),i=require("../Entity"),t=require("../Traits"),s=require("./ManaPot.bubbles"),a=require("./ManaPot.pylon");const r={sounds:[{url:require("../../sounds/picked.wav"),name:"picked"}]};let n=class extends i.Trait{constructor(){super("behavior")}collides(e,i){!e.pickable.picked&&i.picker&&(e.pickable.pick(),e.vel.set(30,-400),e.solid.obstructs=!1)}};const o=exports.loadManaPot=(0,e.defineGameObject)("manaPot",{spriteSpecs:[s.MANA_BUBBLES_SPRITE,a.MANA_PYLON_SPRITE],soundSpecs:[r],traits:({sounds:e})=>[new t.Physics({applyGravity:!1}),new t.Solid,new t.Pickable({onPick:()=>e.get("picked").playOnce()}),new n],animations:e=>{const i=e.animations.get("idle");return e=>i(e.lifetime)}});
},{"../defineGameObject":53,"../Entity":37,"../Traits":52,"./ManaPot.bubbles":58,"./ManaPot.pylon":59,"../../sounds/picked.wav":51}],54:[function(require,module,exports) {
module.exports="66a8edf4aa2f6df810aece7398529cad.png";
},{}],29:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadPortal=void 0;var e=require("../Entity"),t=require("../loaders"),r=require("../Traits"),a=require("../math"),i=require("../defineGameObject");const o={skinName:"default",size:[36,72],offset:[0,0],imageURL:require("../../img/pickables/portal.png"),frames:[{name:"portal-1",rect:[0,0,36,72]},{name:"portal-2",rect:[36,0,36,72]},{name:"portal-3",rect:[72,0,36,72]},{name:"portal-4",rect:[108,0,36,72]},{name:"portal-5",rect:[144,0,36,72]},{name:"portal-6",rect:[180,0,36,72]}],animations:[{name:"portal",frameLen:.1,frames:["portal-1","portal-2","portal-3","portal-4","portal-5","portal-6"]}]};let s=class extends e.Trait{constructor({destintaion:e}){super("behavior"),this.destintaion=e}collides(e,t){if(e.pickable.picked||!t.picker)return;e.pickable.pick(),e.vel.set(30,-400),e.solid.obstructs=!1;const r=this.destintaion||new a.Vec2(this.pos.x+a.rand.int(100,1e3),-100);t.pos.set(r.x,r.y)}};const n=exports.loadPortal=(0,i.defineGameObject)("portal",{spriteSpecs:[o],traits:({destintaion:e})=>[new r.Physics({applyGravity:!1}),new r.Solid,new r.Pickable,new s({destintaion:e})],animations:e=>{const t=e.animations.get("portal");return e=>t(e.lifetime)}});
},{"../Entity":37,"../loaders":23,"../Traits":52,"../math":24,"../defineGameObject":53,"../../img/pickables/portal.png":54}],56:[function(require,module,exports) {
module.exports="5fdd1bbce6cd0a583455dc64a6a69018.png";
},{}],30:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadRainbow=void 0;var e=require("../Entity"),r=require("../Traits"),a=require("../loaders"),s=require("../defineGameObject");const i={imageURL:require("../../img/pickables/rainbow.png"),size:[83,93],offset:[0,0],skinName:"default",frames:[{name:"spark-1",rect:[0,0,83,93]},{name:"spark-2",rect:[83,0,83,93]},{name:"spark-3",rect:[166,0,83,93]},{name:"spark-4",rect:[249,0,83,93]},{name:"spark-5",rect:[332,0,83,93]},{name:"spark-6",rect:[415,0,83,93]}],animations:[{name:"spark",frameLen:.2,frames:["spark-1","spark-2","spark-3","spark-4","spark-5","spark-6"]}]},t={sounds:[{url:require("../../sounds/picked.wav"),name:"picked"}]};let n=class extends e.Trait{constructor(){super("behavior")}collides(e,r){!e.pickable.picked&&r.picker&&(e.pickable.pick(),e.vel.set(30,-400),e.solid.obstructs=!1)}};const p=exports.loadRainbow=(0,s.defineGameObject)("rainbow",{spriteSpecs:[i],soundSpecs:[t],traits:({sounds:e})=>[new r.Physics({applyGravity:!1}),new r.Solid,new r.Pickable({onPick:()=>e.get("picked").playOnce()}),new n],animations:e=>{const r=e.animations.get("spark");return e=>r(e.lifetime)}});
},{"../Entity":37,"../Traits":52,"../loaders":23,"../defineGameObject":53,"../../img/pickables/rainbow.png":56,"../../sounds/picked.wav":51}],75:[function(require,module,exports) {
module.exports="7ae2d19cd5ba43e5dd2ea3624d0b9dc3.png";
},{}],31:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadSpeedBooster=void 0;var e=require("../Entity"),s=require("../loaders"),o=require("../Traits"),r=require("../defineGameObject");const t={imageURL:require("../../img/pickables/horseshoe.png"),size:[45,49],offset:[0,0],skinName:"default",frames:[{name:"horseshoe-1",rect:[0,0,36,49]},{name:"horseshoe-2",rect:[37,0,38,49]},{name:"horseshoe-3",rect:[76,0,35,49]},{name:"horseshoe-4",rect:[112,0,37,49]},{name:"horseshoe-5",rect:[150,0,42,49]},{name:"horseshoe-6",rect:[193,0,43,49]},{name:"horseshoe-7",rect:[237,0,44,49]},{name:"horseshoe-8",rect:[282,0,45,49]},{name:"horseshoe-9",rect:[328,0,35,49]},{name:"horseshoe-10",rect:[368,0,40,49]},{name:"horseshoe-11",rect:[409,0,41,49]},{name:"horseshoe-12",rect:[451,0,45,49]}],animations:[{name:"horseshoe",frameLen:.1,frames:["horseshoe-1","horseshoe-2","horseshoe-3","horseshoe-4","horseshoe-5","horseshoe-6","horseshoe-7","horseshoe-8","horseshoe-9","horseshoe-10","horseshoe-11","horseshoe-12"]}]};let h=class extends e.Trait{constructor(){super("behavior"),this.boost=5e3,this.boostTime=1e4}restoreSpeed(e){e.jump.jumpingUp||e.jump.fallingDown?e.run.queue(()=>this.restoreSpeed(e)):e.run.speed-=this.boost}collides(e,s){!e.pickable.picked&&s.picker&&(e.pickable.pick(),e.vel.set(30,-400),e.solid.obstructs=!1,s.run.speed+=this.boost,setTimeout(()=>this.restoreSpeed.call(this,s),this.boostTime))}};const i={sounds:[{url:require("../../sounds/picked.wav"),name:"picked"}]},n=exports.loadSpeedBooster=(0,r.defineGameObject)("speedBooster",{spriteSpecs:[t],soundSpecs:[i],traits:({sounds:e})=>[new o.Physics({applyGravity:!1}),new o.Solid,new o.Pickable({onPick:()=>e.get("picked").playOnce()}),new h],animations:e=>{const s=e.animations.get("horseshoe");return e=>s(e.lifetime)}});
},{"../Entity":37,"../loaders":23,"../Traits":52,"../defineGameObject":53,"../../img/pickables/horseshoe.png":75,"../../sounds/picked.wav":51}],76:[function(require,module,exports) {
module.exports="978220e47212c38eae031668a1735c22.png";
},{}],74:[function(require,module,exports) {
module.exports="e7be428c06141bfb6383238051f9ddd8.wav";
},{}],32:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadBullet=void 0;var e=require("../defineGameObject"),t=require("../Entity"),i=require("../Traits");const s={skinName:"default",imageURL:require("../../img/weapon/fireball.png"),size:[55,25],offset:[0,35],frames:[{name:"idle-1",rect:[0,1182,97,97]},{name:"idle-2",rect:[98,1182,97,97]},{name:"idle-3",rect:[195,1182,97,97]},{name:"idle-4",rect:[292,1182,97,97]},{name:"idle-5",rect:[389,1182,97,97]},{name:"idle-6",rect:[486,1182,97,97]},{name:"idle-7",rect:[583,1182,97,97]}],animations:[{name:"idle",frameLen:.1,frames:["idle-4","idle-5","idle-6","idle-7"]}]},l={sounds:[{url:require("../../sounds/fireball-cast.wav"),name:"cast"}]};let r=class extends t.Trait{constructor(e,t){super("bulletBehavior"),this.ownerEntity=e,this.sounds=t,this.destroyed=!1}destroy(){this.queue(()=>{this.destroyed=!0})}update(e,t,i){this.destroyed&&this.queue(()=>{i.entities.delete(e)})}obstruct(){this.destroy()}collides(e,t){t.killable&&!t.killable.dead&&t!==this.ownerEntity&&(this.ownerEntity.killer&&this.ownerEntity.killer.kill(t),t.killable.kill())}striked(){this.sounds.get("cast").playOnce({volume:.1,rate:3})}};const n=exports.loadBullet=(0,e.defineGameObject)("bullet",{spriteSpecs:[s],soundSpecs:[l],traits:({ownerEntity:e,sounds:t})=>[new i.Physics({applyGravity:!1}),new i.Solid,new r(e,t)],animations:e=>{const t=e.animations.get("idle");return e=>t(e.lifetime)}});
},{"../defineGameObject":53,"../Entity":37,"../Traits":52,"../../img/weapon/fireball.png":76,"../../sounds/fireball-cast.wav":74}],60:[function(require,module,exports) {
module.exports="e95cf42e300fc82b8144de80e5aeda67.png";
},{}],33:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadDoor=void 0;var e=require("../Entity"),t=require("../loaders"),i=require("../Traits"),o=require("../math"),n=require("../defineGameObject");const s={size:[120,165],offset:[0,0],skinName:"default",imageURL:require("../../img/other/doors.png"),frames:[{name:"idle",rect:[407,41,120,165]},{name:"open-1",rect:[407,287,120,165]},{name:"open-2",rect:[407,535,120,165]},{name:"open-3",rect:[407,700,120,165]}],animations:[{name:"open",frameLen:.1,frames:["open-1","open-2","open-3"]}]};let r=class extends e.Trait{constructor(){super("behavior"),this.opened=!1,this.openedTime=0,this.openDuration=.3}open(){this.queue(()=>{this.opened=!0,this.entity.impassable.deactivate()})}close(){this.queue(()=>{this.opened=!1,this.entity.impassable.activate()})}update(e,t,i){this.opened&&this.openedTime<this.openDuration&&(this.openedTime+=t)}collides(e,t,i){this.opened||t.obstruct(t,i)}};const a=exports.loadDoor=(0,n.defineGameObject)("door",{spriteSpecs:[s],traits:()=>[new i.Impassable,new r],animations:e=>{const t=e.animations.get("open");return e=>e.behavior.opened?t(e.behavior.openedTime):"idle"}});
},{"../Entity":37,"../loaders":23,"../Traits":52,"../math":24,"../defineGameObject":53,"../../img/other/doors.png":60}],10:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadEntities=s;var e=require("./chars/Enemy"),o=require("./chars/Unicorn"),r=require("./other/Ufo"),t=require("./pickables/ManaPot"),n=require("./pickables/Portal"),a=require("./pickables/Rainbow"),l=require("./pickables/SpeedBooster"),i=require("./weapon/Bullet"),u=require("./other/Door");function s(){const s={};function d(e){return o=>s[e]=o}return Promise.all([(0,o.loadUnicorn)().then(d("unicorn")),(0,e.loadEnemy)().then(d("enemy")),(0,a.loadRainbow)().then(d("rainbow")),(0,l.loadSpeedBooster)().then(d("speedBooster")),(0,n.loadPortal)().then(d("portal")),(0,i.loadBullet)().then(d("bullet")),(0,t.loadManaPot)().then(d("manaPot")),(0,r.loadUfo)().then(d("ufo")),(0,u.loadDoor)().then(d("door"))]).then(()=>s)}
},{"./chars/Enemy":25,"./chars/Unicorn":26,"./other/Ufo":27,"./pickables/ManaPot":28,"./pickables/Portal":29,"./pickables/Rainbow":30,"./pickables/SpeedBooster":31,"./weapon/Bullet":32,"./other/Door":33}],44:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TileCollider=exports.TileResolver=void 0;var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},t=require("./Entity");let i=exports.TileResolver=class{constructor(e,t=60){this.matrix=e,this.tileSize=t}toIndex(e){return e>=0?Math.floor(e/this.tileSize):Math.ceil(e/this.tileSize)-1}toIndexRange(e,t,i){const s=Math.ceil(t/this.tileSize)*this.tileSize,o=[];let r=e;do{o.push(this.toIndex(r)),r+=this.tileSize}while(r<s);return o}getByIndex(t,i){const s=this.matrix.get(t,i);if(s){const o=t*this.tileSize,r=o+this.tileSize,l=i*this.tileSize,n=l+this.tileSize;return e({},s,{indexX:t,indexY:i,x1:o,x2:r,y1:l,y2:n})}}getTilePos(e,t){const i=e*this.tileSize,s=i+this.tileSize,o=t*this.tileSize;return{x1:i,x2:s,y1:o,y2:o+this.tileSize}}searchByPosition(e,t){const i=this.toIndex(e),s=this.toIndex(t);return this.getByIndex(i,s)}searchByRange(e,t,i,s){const o=[];return this.toIndexRange(e,t).forEach(e=>{this.toIndexRange(i,s).forEach(t=>{const i=this.getByIndex(e,t);i&&o.push(i)})}),o}},s=exports.TileCollider=class{constructor(e){this.tiles=new i(e)}willCollideX(e,t){let i;if(e.vel.x>0)i=e.bounds.right;else{if(!(e.vel.x<0))return;i=e.bounds.left}return this.tiles.searchByRange(i,i+t,e.bounds.top,e.bounds.bottom).length>0}checkX(e){let i;if(e.vel.x>0)i=e.bounds.right;else{if(!(e.vel.x<0))return;i=e.bounds.left}this.tiles.searchByRange(i,i,e.bounds.top,e.bounds.bottom).forEach(i=>{e.vel.x>0?e.bounds.right>i.x1&&e.obstruct(t.Sides.RIGHT,i):e.vel.x<0&&e.bounds.left<i.x2&&e.obstruct(t.Sides.LEFT,i)})}checkY(e){let i;if(e.vel.y>0)i=e.bounds.bottom;else{if(!(e.vel.y<0))return;i=e.bounds.top}this.tiles.searchByRange(e.bounds.left,e.bounds.right,i,i).forEach(i=>{e.vel.y>0?e.bounds.bottom>i.y1&&e.obstruct(t.Sides.BOTTOM,i):e.vel.y<0&&e.bounds.top<i.y2&&e.obstruct(t.Sides.TOP,i)})}};
},{"./Entity":37}],21:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createBackgroundLayer=o,exports.createStaticBackgroundLayer=n,exports.createSpriteLayer=i,exports.createDebugLayer=c;var e=require("./math"),t=require("./TileCreation");function o(e,o){const n=new t.TileResolver(e.tileGrid),i=document.createElement("canvas");i.width=1084,i.height=660;const c=i.getContext("2d");function s(t,n,s,r){c.clearRect(0,0,i.width,i.height);const a=t,d=t+s,l=n,h=n+r;for(let t=a;t<=d;++t)for(let n=l;n<=h;n++){const i=e.tileGrid.get(t,n);if(i){const e=i.skinName||"default";o.drawTile(e,c,t-a,n-l)}}}return function(e,t){const o=n.toIndex(t.size.x),c=n.toIndex(t.size.y),r=n.toIndex(t.pos.x),a=n.toIndex(t.pos.y),d=r<0?60:0,l=a<0?60:0;s(r,a,o,c),e.drawImage(i,-t.pos.x%60-d,-t.pos.y%60-l)}}function n(e,t,o){const n=document.createElement("canvas");n.width=1084,n.height=660;n.getContext("2d");const i={SkyImage:t.sky,BackImage:t.back,FrontImage:t.front};return function(t,c){!function(e,t){const i=e.createLinearGradient(0,0,0,n.width),c=o(t.pos);for(const[e,t]of c)i.addColorStop(t,e);e.fillStyle=i,e.fillRect(0,0,n.width,n.height)}(t,c),function(t,o){const n=i.SkyImage,c=i.BackImage,s=i.FrontImage,r=s||c||n,a=Math.floor(e.distance/(r?r.width:1))+5,d=-o.pos.x/2.9,l=-o.pos.x/1.9,h=-o.pos.x/.9,u=.05*-o.pos.y,f=.07*-o.pos.y,g=.2*-o.pos.y;for(let e=0;e<a;e++)n&&t.drawImage(n,d+n.width*e+500*e,u),c&&t.drawImage(c,l+c.width*e,f+o.size.y-c.height),s&&t.drawImage(s,h+s.width*e,g+o.size.y-s.height)}(t,c)}}function i(e,t=240,o=350){const n=document.createElement("canvas");n.width=t,n.height=o;const i=n.getContext("2d");return function(c,s){e.forEach(e=>{i.clearRect(0,0,t,o),e.draw(i),c.drawImage(n,e.pos.x-s.pos.x,e.pos.y-s.pos.y)})}}function c(e){const t=document.createElement("canvas");t.width=1084,t.height=660;const o=t.getContext("2d");function n(n){o.clearRect(0,0,t.width,t.height);const i=n.getBounds(),c=e.level,s=e.selection.selectedEntity,r=e.selection.selectedTile;if(s)for(const e of c.entities)i.overlaps(e.bounds)&&(o.beginPath(),o.strokeStyle=s===e?"white":"black",o.lineWidth=s===e?2:1,o.rect(e.bounds.left-i.left,e.bounds.top-i.top,e.size.x,e.size.y),o.stroke(),o.closePath());else if(r){const e=r;o.beginPath(),o.strokeStyle="white",o.lineWidth=2,o.rect(e.x1-n.pos.x,e.y1-n.pos.y,e.x2-e.x1,e.y2-e.y1),o.stroke(),o.closePath()}}return function(e,o){!function(e,o){n(o),e.drawImage(t,0,0)}(e,o)}}
},{"./math":24,"./TileCreation":44}],48:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let s=exports.Compositor=class{constructor(){this.layers=[]}addLayer(s){this.layers.push(s)}draw(s,e){this.layers.forEach(r=>{r(s,e)})}};
},{}],49:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityCollider=void 0;var t=require("./Entity");let o=exports.EntityCollider=class{constructor(t){this.entities=t}check(t){this.entities.forEach(o=>{if(t!==o&&t.bounds.overlaps(o.bounds)){const e=this.getSideY(t,o)||this.getSideX(t,o);t.collides(o,e)}})}getSideX(o,e){return o.bounds.left>e.bounds.left&&o.bounds.left<e.bounds.right?t.Sides.LEFT:o.bounds.right<e.bounds.right&&o.bounds.right>e.bounds.left?t.Sides.RIGHT:void 0}getSideY(o,e){return o.bounds.top>e.bounds.top&&o.bounds.top<e.bounds.bottom?t.Sides.TOP:o.bounds.bottom<e.bounds.bottom&&o.bounds.bottom>e.bounds.top?t.Sides.BOTTOM:void 0}};
},{"./Entity":37}],22:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Level=void 0;var i=require("./Compositor"),e=require("./EntityCollider"),t=require("./TileCreation");let s=exports.Level=class{constructor(t){this.name=t,this.gravity=1500,this.totalTime=0,this.distance=0,this.freeze=!1,this.comp=new i.Compositor,this.entities=new Set,this.namedEntities=new Map,this.entityCollider=new e.EntityCollider(this.entities),this.tileCollider=void 0,this.tileGrid=void 0}setTileGrid(i){this.tileGrid=i,this.tileCollider=new t.TileCollider(i)}setDistance(i){this.distance=i}update(i){this.frozen||(this.entities.forEach(e=>{e.update(i,this)}),this.entities.forEach(i=>{this.entityCollider.check(i)}),this.entities.forEach(i=>{i.finalize()}),this.totalTime+=i)}};
},{"./Compositor":48,"./EntityCollider":49,"./TileCreation":44}],11:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createLevelLoader=c;var e=require("./layers"),t=require("./Level"),n=require("./loaders"),r=require("./math");function o(e,t){const n=d(e.tiles);t.setTileGrid(n),t.setDistance(60*n.width())}function i(t,n,r,o,i){const s=(0,e.createBackgroundLayer)(n,i),a=(0,e.createStaticBackgroundLayer)(n,r,o);n.comp.addLayer(a),n.comp.addLayer(s)}function s(t,n,r){t.entities.forEach((e,t)=>{const o=(0,r[e.name])(e);o.pos.set(e.pos[0],e.pos[1]),o.idx=t,n.entities.add(o),e.id&&n.namedEntities.set(e.id,o)});const o=(0,e.createSpriteLayer)(n.entities);n.comp.addLayer(o)}function a(e,t){e.sounds=t}function c(e){return function(r){return Promise.resolve(r).then(e=>Promise.all([e,(0,n.loadImages)(e.background.images),e.background.gradient,(0,n.loadSpriteSheet)(e.tileSprite),e.sounds&&(0,n.loadSounds)(e)])).then(([n,r,c,d,u])=>{const l=new t.Level(n.name);return o(n,l),i(n,l,r,c,d),s(n,l,e),a(l,u),l})}}function d(e){const t=new r.Matrix;for(const n of m(e)){const{skinName:e,x:r,y:o}=n,i={skinName:e||"default"};t.set(r,o,i)}return t}function*u(e,t,n,r,o){const i=t+n,s=r+o;for(let n=t;n<i;++n)for(let t=r;t<s;++t)yield{skinName:e,x:n,y:t}}function l(e){const t="string"==typeof e[0],n=t?e[0]:void 0;if(4===(e=t?e.slice(1):e).length){const[t,r,o,i]=e;return u(n,t,r,o,i)}if(3===e.length){const[t,r,o]=e;return u(n,t,r,o,1)}if(2===e.length){const[t,r]=e;return u(n,t,1,r,1)}}function*f(e){for(const t of e)yield*l(t)}function*m(e){yield*f(e)}
},{"./layers":21,"./Level":22,"./loaders":23,"./math":24}],12:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let e=exports.Timer=class{constructor(e=1/60){this.rafId=void 0;let t=0,s=0;this.updateProxy=(r=>{for((t+=(r-s)/1e3)>1&&(t=1);t>e;)this.update(e,r),t-=e;s=r,this.enqueue()})}update(){}enqueue(){this.rafId=requestAnimationFrame(this.updateProxy)}start(){this.enqueue()}stop(){cancelAnimationFrame(this.rafId)}};
},{}],4:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Game=void 0;var e=require("./camera/Camera"),a=require("./camera/CameraController"),r=require("./camera/CameraFocus"),t=require("./camera/CameraShake"),s=require("./LevelManager"),i=require("./loadEntities"),l=require("./loadLevel"),n=require("./player/createPlayerEnv"),o=require("./Timer"),h=require("./Splash");let v=exports.Game=class{constructor(i){this.canvasSelector=i,this.context=i.getContext("2d"),this.camera=new e.Camera,this.timer=new o.Timer,this.levelManager=new s.LevelManager(this),this.cameraController=new a.CameraController(this.camera,[t.CameraShake,r.CameraFocus]),this.playerEnv=(0,n.createPlayerEnv)(this),this.paused=!1,this.levelManager.on(s.LevelEvents.FINISHED,this.onLevelFinished.bind(this)),this.levelManager.on(s.LevelEvents.FAILED,this.onLevelFailed.bind(this)),this.loadResources()}async loadResources(){this.entityFactory=await(0,i.loadEntities)(),this.loadLevel=await(0,l.createLevelLoader)(this.entityFactory),this.timer.start(),this.onLoad()}async onLoad(){this.levelManager.runLevel()}onLevelFinished({isLastLevel:e}){e?this.onGameOver():this.levelManager.nextLevel()}onLevelFailed(){this.levelManager.restartLevel()}async onGameOver(){this.pause();const e=this.playerEnv.playerController;await(0,h.splash)("you win! <br> congratulations!",{size:50,background:"rgba(0,0,0,0.5)"});const a=`\n            score: ${e.totalScore} <br> \n            Deaths: ${e.deaths}\n        `;(0,h.splash)(a,{size:50,background:"rgba(0,0,0,0.5)",timeout:1e5})}pause(){this.levelManager.level.frozen=!0,this.paused=!0}resume(){this.levelManager.level.frozen=!1,this.paused=!1}};
},{"./camera/Camera":14,"./camera/CameraController":16,"./camera/CameraFocus":17,"./camera/CameraShake":18,"./LevelManager":9,"./loadEntities":10,"./loadLevel":11,"./player/createPlayerEnv":19,"./Timer":12,"./Splash":13}],3:[function(require,module,exports) {
"use strict";var e=require("./Game");const t=document.getElementById("screen"),n=new e.Game(t);
},{"./Game":4}]},{},[3])